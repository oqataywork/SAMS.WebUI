/*!
 * wavesurfer.js 3.3.1 (2020-01-14)
 * https://github.com/katspaugh/wavesurfer.js
 * @license BSD-3-Clause
 */
!function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("WaveSurfer", [], t) : "object" == typeof exports ? exports.WaveSurfer = t() : e.WaveSurfer = t() }(window, function () { return function (e) { var t = {}; function r(n) { if (t[n]) return t[n].exports; var i = t[n] = { i: n, l: !1, exports: {} }; return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports } return r.m = e, r.c = t, r.d = function (e, t, n) { r.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n }) }, r.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, r.t = function (e, t) { if (1 & t && (e = r(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var n = Object.create(null); if (r.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) r.d(n, i, function (t) { return e[t] }.bind(null, i)); return n }, r.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return r.d(t, "a", t), t }, r.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, r.p = "", r(r.s = "./src/wavesurfer.js") }({ "./node_modules/debounce/index.js": function (e, t) { function r(e, t, r) { var n, i, a, s, o; function u() { var l = Date.now() - s; l < t && l >= 0 ? n = setTimeout(u, t - l) : (n = null, r || (o = e.apply(a, i), a = i = null)) } null == t && (t = 100); var l = function () { a = this, i = arguments, s = Date.now(); var l = r && !n; return n || (n = setTimeout(u, t)), l && (o = e.apply(a, i), a = i = null), o }; return l.clear = function () { n && (clearTimeout(n), n = null) }, l.flush = function () { n && (o = e.apply(a, i), a = i = null, clearTimeout(n), n = null) }, l } r.debounce = r, e.exports = r }, "./src/drawer.canvasentry.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n = a(r("./src/util/style.js")), i = a(r("./src/util/get-id.js")); function a(e) { return e && e.__esModule ? e : { default: e } } function s(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } var o = function () { function e() { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.wave = null, this.waveCtx = null, this.progress = null, this.progressCtx = null, this.start = 0, this.end = 1, this.id = (0, i.default)(void 0 !== this.constructor.name ? this.constructor.name.toLowerCase() + "_" : "canvasentry_"), this.canvasContextAttributes = {} } var t, r, a; return t = e, (r = [{ key: "initWave", value: function (e) { this.wave = e, this.waveCtx = this.wave.getContext("2d", this.canvasContextAttributes) } }, { key: "initProgress", value: function (e) { this.progress = e, this.progressCtx = this.progress.getContext("2d", this.canvasContextAttributes) } }, { key: "updateDimensions", value: function (e, t, r, i) { this.start = this.wave.offsetLeft / t || 0, this.end = this.start + e / t, this.wave.width = r, this.wave.height = i; var a = { width: e + "px" }; (0, n.default)(this.wave, a), this.hasProgressCanvas && (this.progress.width = r, this.progress.height = i, (0, n.default)(this.progress, a)) } }, { key: "clearWave", value: function () { this.waveCtx.clearRect(0, 0, this.waveCtx.canvas.width, this.waveCtx.canvas.height), this.hasProgressCanvas && this.progressCtx.clearRect(0, 0, this.progressCtx.canvas.width, this.progressCtx.canvas.height) } }, { key: "setFillStyles", value: function (e, t) { this.waveCtx.fillStyle = e, this.hasProgressCanvas && (this.progressCtx.fillStyle = t) } }, { key: "fillRects", value: function (e, t, r, n, i) { this.fillRectToContext(this.waveCtx, e, t, r, n, i), this.hasProgressCanvas && this.fillRectToContext(this.progressCtx, e, t, r, n, i) } }, { key: "fillRectToContext", value: function (e, t, r, n, i, a) { e && (a ? this.drawRoundedRect(e, t, r, n, i, a) : e.fillRect(t, r, n, i)) } }, { key: "drawRoundedRect", value: function (e, t, r, n, i, a) { 0 !== i && (i < 0 && (r -= i *= -1), e.beginPath(), e.moveTo(t + a, r), e.lineTo(t + n - a, r), e.quadraticCurveTo(t + n, r, t + n, r + a), e.lineTo(t + n, r + i - a), e.quadraticCurveTo(t + n, r + i, t + n - a, r + i), e.lineTo(t + a, r + i), e.quadraticCurveTo(t, r + i, t, r + i - a), e.lineTo(t, r + a), e.quadraticCurveTo(t, r, t + a, r), e.closePath(), e.fill()) } }, { key: "drawLines", value: function (e, t, r, n, i, a) { this.drawLineToContext(this.waveCtx, e, t, r, n, i, a), this.hasProgressCanvas && this.drawLineToContext(this.progressCtx, e, t, r, n, i, a) } }, { key: "drawLineToContext", value: function (e, t, r, n, i, a, s) { if (e) { var o, u, l, c = t.length / 2, h = Math.round(c * this.start), d = h, f = Math.round(c * this.end) + 1, p = this.wave.width / (f - d - 1), v = n + i, m = r / n; for (e.beginPath(), e.moveTo((d - h) * p, v), e.lineTo((d - h) * p, v - Math.round((t[2 * d] || 0) / m)), o = d; o < f; o++)u = t[2 * o] || 0, l = Math.round(u / m), e.lineTo((o - h) * p + this.halfPixel, v - l); for (var y = f - 1; y >= d; y--)u = t[2 * y + 1] || 0, l = Math.round(u / m), e.lineTo((y - h) * p + this.halfPixel, v - l); e.lineTo((d - h) * p, v - Math.round((t[2 * d + 1] || 0) / m)), e.closePath(), e.fill() } } }, { key: "destroy", value: function () { this.waveCtx = null, this.wave = null, this.progressCtx = null, this.progress = null } }, { key: "getImage", value: function (e, t, r) { var n = this; return "blob" === r ? new Promise(function (r) { n.wave.toBlob(r, e, t) }) : "dataURL" === r ? this.wave.toDataURL(e, t) : void 0 } }]) && s(t.prototype, r), a && s(t, a), e }(); t.default = o, e.exports = t.default }, "./src/drawer.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n = function (e) { if (e && e.__esModule) return e; if (null === e || "object" !== a(e) && "function" != typeof e) return { default: e }; var t = i(); if (t && t.has(e)) return t.get(e); var r = {}, n = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var s in e) if (Object.prototype.hasOwnProperty.call(e, s)) { var o = n ? Object.getOwnPropertyDescriptor(e, s) : null; o && (o.get || o.set) ? Object.defineProperty(r, s, o) : r[s] = e[s] } r.default = e, t && t.set(e, r); return r }(r("./src/util/index.js")); function i() { if ("function" != typeof WeakMap) return null; var e = new WeakMap; return i = function () { return e }, e } function a(e) { return (a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function s(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function o(e, t) { return !t || "object" !== a(t) && "function" != typeof t ? function (e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e }(e) : t } function u(e) { return (u = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function l(e, t) { return (l = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var c = function (e) { function t(e, r) { var n; return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), (n = o(this, u(t).call(this))).container = e, n.params = r, n.width = 0, n.height = r.height * n.params.pixelRatio, n.lastPos = 0, n.wrapper = null, n } var r, i, a; return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && l(e, t) }(t, n.Observer), r = t, (i = [{ key: "style", value: function (e, t) { return n.style(e, t) } }, { key: "createWrapper", value: function () { this.wrapper = this.container.appendChild(document.createElement("wave")), this.style(this.wrapper, { display: "block", position: "relative", userSelect: "none", webkitUserSelect: "none", height: this.params.height + "px" }), (this.params.fillParent || this.params.scrollParent) && this.style(this.wrapper, { width: "100%", overflowX: this.params.hideScrollbar ? "hidden" : "auto", overflowY: "hidden" }), this.setupWrapperEvents() } }, { key: "handleEvent", value: function (e, t) { !t && e.preventDefault(); var r, n = e.targetTouches ? e.targetTouches[0].clientX : e.clientX, i = this.wrapper.getBoundingClientRect(), a = this.width, s = this.getWidth(); return !this.params.fillParent && a < s ? (r = (this.params.rtl ? i.right - n : n - i.left) * (this.params.pixelRatio / a) || 0) > 1 && (r = 1) : r = ((this.params.rtl ? i.right - n : n - i.left) + this.wrapper.scrollLeft) / this.wrapper.scrollWidth || 0, r } }, { key: "setupWrapperEvents", value: function () { var e = this; this.wrapper.addEventListener("click", function (t) { var r = e.wrapper.offsetHeight - e.wrapper.clientHeight; if (0 !== r) { var n = e.wrapper.getBoundingClientRect(); if (t.clientY >= n.bottom - r) return } e.params.interact && e.fireEvent("click", t, e.handleEvent(t)) }), this.wrapper.addEventListener("dblclick", function (t) { e.params.interact && e.fireEvent("dblclick", t, e.handleEvent(t)) }), this.wrapper.addEventListener("scroll", function (t) { return e.fireEvent("scroll", t) }) } }, { key: "drawPeaks", value: function (e, t, r, n) { this.setWidth(t) || this.clearWave(), this.params.barWidth ? this.drawBars(e, 0, r, n) : this.drawWave(e, 0, r, n) } }, { key: "resetScroll", value: function () { null !== this.wrapper && (this.wrapper.scrollLeft = 0) } }, { key: "recenter", value: function (e) { var t = this.wrapper.scrollWidth * e; this.recenterOnPosition(t, !0) } }, { key: "recenterOnPosition", value: function (e, t) { var r = this.wrapper.scrollLeft, n = ~~(this.wrapper.clientWidth / 2), i = this.wrapper.scrollWidth - this.wrapper.clientWidth, a = e - n, s = a - r; if (0 != i) { if (!t && -n <= s && s < n) { var o = this.params.autoCenterRate; o /= n, o *= i, a = r + (s = Math.max(-o, Math.min(o, s))) } (a = Math.max(0, Math.min(i, a))) != r && (this.wrapper.scrollLeft = a) } } }, { key: "getScrollX", value: function () { var e = 0; if (this.wrapper) { var t = this.params.pixelRatio; if (e = Math.round(this.wrapper.scrollLeft * t), this.params.scrollParent) { var r = ~~(this.wrapper.scrollWidth * t - this.getWidth()); e = Math.min(r, Math.max(0, e)) } } return e } }, { key: "getWidth", value: function () { return Math.round(this.container.clientWidth * this.params.pixelRatio) } }, { key: "setWidth", value: function (e) { return this.width != e && (this.width = e, this.params.fillParent || this.params.scrollParent ? this.style(this.wrapper, { width: "" }) : this.style(this.wrapper, { width: ~~(this.width / this.params.pixelRatio) + "px" }), this.updateSize(), !0) } }, { key: "setHeight", value: function (e) { return e != this.height && (this.height = e, this.style(this.wrapper, { height: ~~(this.height / this.params.pixelRatio) + "px" }), this.updateSize(), !0) } }, { key: "progress", value: function (e) { var t = 1 / this.params.pixelRatio, r = Math.round(e * this.width) * t; if (r < this.lastPos || r - this.lastPos >= t) { if (this.lastPos = r, this.params.scrollParent && this.params.autoCenter) { var n = ~~(this.wrapper.scrollWidth * e); this.recenterOnPosition(n, this.params.autoCenterImmediately) } this.updateProgress(r) } } }, { key: "destroy", value: function () { this.unAll(), this.wrapper && (this.wrapper.parentNode == this.container && this.container.removeChild(this.wrapper), this.wrapper = null) } }, { key: "updateCursor", value: function () { } }, { key: "updateSize", value: function () { } }, { key: "drawBars", value: function (e, t, r, n) { } }, { key: "drawWave", value: function (e, t, r, n) { } }, { key: "clearWave", value: function () { } }, { key: "updateProgress", value: function (e) { } }]) && s(r.prototype, i), a && s(r, a), t }(); t.default = c, e.exports = t.default }, "./src/drawer.multicanvas.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n = o(r("./src/drawer.js")), i = function (e) { if (e && e.__esModule) return e; if (null === e || "object" !== u(e) && "function" != typeof e) return { default: e }; var t = s(); if (t && t.has(e)) return t.get(e); var r = {}, n = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var i in e) if (Object.prototype.hasOwnProperty.call(e, i)) { var a = n ? Object.getOwnPropertyDescriptor(e, i) : null; a && (a.get || a.set) ? Object.defineProperty(r, i, a) : r[i] = e[i] } r.default = e, t && t.set(e, r); return r }(r("./src/util/index.js")), a = o(r("./src/drawer.canvasentry.js")); function s() { if ("function" != typeof WeakMap) return null; var e = new WeakMap; return s = function () { return e }, e } function o(e) { return e && e.__esModule ? e : { default: e } } function u(e) { return (u = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function l(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function c(e, t) { return !t || "object" !== u(t) && "function" != typeof t ? function (e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e }(e) : t } function h(e) { return (h = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function d(e, t) { return (d = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var f = function (e) { function t(e, r) { var n; return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), (n = c(this, h(t).call(this, e, r))).maxCanvasWidth = r.maxCanvasWidth, n.maxCanvasElementWidth = Math.round(r.maxCanvasWidth / r.pixelRatio), n.hasProgressCanvas = r.waveColor != r.progressColor, n.halfPixel = .5 / r.pixelRatio, n.canvases = [], n.progressWave = null, n.EntryClass = a.default, n.canvasContextAttributes = r.drawingContextAttributes, n.overlap = 2 * Math.ceil(r.pixelRatio / 2), n.barRadius = r.barRadius || 0, n } var r, s, o; return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && d(e, t) }(t, n.default), r = t, (s = [{ key: "init", value: function () { this.createWrapper(), this.createElements() } }, { key: "createElements", value: function () { this.progressWave = this.wrapper.appendChild(this.style(document.createElement("wave"), { position: "absolute", zIndex: 3, left: 0, top: 0, bottom: 0, overflow: "hidden", width: "0", display: "none", boxSizing: "border-box", borderRightStyle: "solid", pointerEvents: "none" })), this.addCanvas(), this.updateCursor() } }, { key: "updateCursor", value: function () { this.style(this.progressWave, { borderRightWidth: this.params.cursorWidth + "px", borderRightColor: this.params.cursorColor }) } }, { key: "updateSize", value: function () { for (var e = this, t = Math.round(this.width / this.params.pixelRatio), r = Math.ceil(t / (this.maxCanvasElementWidth + this.overlap)); this.canvases.length < r;)this.addCanvas(); for (; this.canvases.length > r;)this.removeCanvas(); var n = this.maxCanvasWidth + this.overlap, i = this.canvases.length - 1; this.canvases.forEach(function (t, r) { r == i && (n = e.width - e.maxCanvasWidth * i), e.updateDimensions(t, n, e.height), t.clearWave() }) } }, { key: "addCanvas", value: function () { var e = new this.EntryClass; e.canvasContextAttributes = this.canvasContextAttributes, e.hasProgressCanvas = this.hasProgressCanvas, e.halfPixel = this.halfPixel; var t = this.maxCanvasElementWidth * this.canvases.length; e.initWave(this.wrapper.appendChild(this.style(document.createElement("canvas"), { position: "absolute", zIndex: 2, left: t + "px", top: 0, bottom: 0, height: "100%", pointerEvents: "none" }))), this.hasProgressCanvas && e.initProgress(this.progressWave.appendChild(this.style(document.createElement("canvas"), { position: "absolute", left: t + "px", top: 0, bottom: 0, height: "100%" }))), this.canvases.push(e) } }, { key: "removeCanvas", value: function () { var e = this.canvases[this.canvases.length - 1]; e.wave.parentElement.removeChild(e.wave), this.hasProgressCanvas && e.progress.parentElement.removeChild(e.progress), e && (e.destroy(), e = null), this.canvases.pop() } }, { key: "updateDimensions", value: function (e, t, r) { var n = Math.round(t / this.params.pixelRatio), i = Math.round(this.width / this.params.pixelRatio); e.updateDimensions(n, i, t, r), this.style(this.progressWave, { display: "block" }) } }, { key: "clearWave", value: function () { var e = this; i.frame(function () { e.canvases.forEach(function (e) { return e.clearWave() }) })() } }, { key: "drawBars", value: function (e, t, r, n) { var i = this; return this.prepareDraw(e, t, r, n, function (e) { var t = e.absmax, a = e.hasMinVals, s = (e.height, e.offsetY), o = e.halfH, u = e.peaks; if (void 0 !== r) for (var l = a ? 2 : 1, c = u.length / l, h = i.params.barWidth * i.params.pixelRatio, d = h + (null === i.params.barGap ? Math.max(i.params.pixelRatio, ~~(h / 2)) : Math.max(i.params.pixelRatio, i.params.barGap * i.params.pixelRatio)), f = c / i.width, p = n, v = r; v < p; v += d) { var m = u[Math.floor(v * f * l)] || 0, y = Math.round(m / t * o); 0 == y && i.params.barMinHeight && (y = i.params.barMinHeight), i.fillRect(v + i.halfPixel, o - y + s, h + i.halfPixel, 2 * y, i.barRadius) } }) } }, { key: "drawWave", value: function (e, t, r, n) { var i = this; return this.prepareDraw(e, t, r, n, function (e) { var t = e.absmax, a = e.hasMinVals, s = (e.height, e.offsetY), o = e.halfH, u = e.peaks; if (!a) { for (var l = [], c = u.length, h = 0; h < c; h++)l[2 * h] = u[h], l[2 * h + 1] = -u[h]; u = l } void 0 !== r && i.drawLine(u, t, o, s, r, n), i.fillRect(0, o + s - i.halfPixel, i.width, i.halfPixel, i.barRadius) }) } }, { key: "drawLine", value: function (e, t, r, n, i, a) { var s = this; this.canvases.forEach(function (o) { s.setFillStyles(o), o.drawLines(e, t, r, n, i, a) }) } }, { key: "fillRect", value: function (e, t, r, n, i) { for (var a = Math.floor(e / this.maxCanvasWidth), s = Math.min(Math.ceil((e + r) / this.maxCanvasWidth) + 1, this.canvases.length), o = a; o < s; o++) { var u = this.canvases[o], l = o * this.maxCanvasWidth, c = { x1: Math.max(e, o * this.maxCanvasWidth), y1: t, x2: Math.min(e + r, o * this.maxCanvasWidth + u.wave.width), y2: t + n }; c.x1 < c.x2 && (this.setFillStyles(u), u.fillRects(c.x1 - l, c.y1, c.x2 - c.x1, c.y2 - c.y1, i)) } } }, { key: "prepareDraw", value: function (e, t, r, n, a) { var s = this; return i.frame(function () { if (e[0] instanceof Array) { var o = e; if (s.params.splitChannels) return s.setHeight(o.length * s.params.height * s.params.pixelRatio), o.forEach(function (e, t) { return s.prepareDraw(e, t, r, n, a) }); e = o[0] } var u = 1 / s.params.barHeight; if (s.params.normalize) { var l = i.max(e), c = i.min(e); u = -c > l ? -c : l } var h = [].some.call(e, function (e) { return e < 0 }), d = s.params.height * s.params.pixelRatio; return a({ absmax: u, hasMinVals: h, height: d, offsetY: d * t || 0, halfH: d / 2, peaks: e }) })() } }, { key: "setFillStyles", value: function (e) { e.setFillStyles(this.params.waveColor, this.params.progressColor) } }, { key: "getImage", value: function (e, t, r) { if ("blob" === r) return Promise.all(this.canvases.map(function (n) { return n.getImage(e, t, r) })); if ("dataURL" === r) { var n = this.canvases.map(function (n) { return n.getImage(e, t, r) }); return n.length > 1 ? n : n[0] } } }, { key: "updateProgress", value: function (e) { this.style(this.progressWave, { width: e + "px" }) } }]) && l(r.prototype, s), o && l(r, o), t }(); t.default = f, e.exports = t.default }, "./src/mediaelement-webaudio.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n, i = (n = r("./src/mediaelement.js")) && n.__esModule ? n : { default: n }; function a(e) { return (a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function s(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function o(e, t) { return !t || "object" !== a(t) && "function" != typeof t ? function (e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e }(e) : t } function u(e, t, r) { return (u = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function (e, t, r) { var n = function (e, t) { for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = l(e));); return e }(e, t); if (n) { var i = Object.getOwnPropertyDescriptor(n, t); return i.get ? i.get.call(r) : i.value } })(e, t, r || e) } function l(e) { return (l = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function c(e, t) { return (c = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var h = function (e) { function t(e) { var r; return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), (r = o(this, l(t).call(this, e))).params = e, r.sourceMediaElement = null, r } var r, n, a; return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && c(e, t) }(t, i.default), r = t, (n = [{ key: "init", value: function () { this.setPlaybackRate(this.params.audioRate), this.createTimer(), this.createVolumeNode(), this.createScriptNode(), this.createAnalyserNode() } }, { key: "_load", value: function (e, r) { u(l(t.prototype), "_load", this).call(this, e, r), this.createMediaElementSource(e) } }, { key: "createMediaElementSource", value: function (e) { this.sourceMediaElement = this.ac.createMediaElementSource(e), this.sourceMediaElement.connect(this.analyser) } }]) && s(r.prototype, n), a && s(r, a), t }(); t.default = h, e.exports = t.default }, "./src/mediaelement.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n, i = (n = r("./src/webaudio.js")) && n.__esModule ? n : { default: n }, a = function (e) { if (e && e.__esModule) return e; if (null === e || "object" !== o(e) && "function" != typeof e) return { default: e }; var t = s(); if (t && t.has(e)) return t.get(e); var r = {}, n = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var i in e) if (Object.prototype.hasOwnProperty.call(e, i)) { var a = n ? Object.getOwnPropertyDescriptor(e, i) : null; a && (a.get || a.set) ? Object.defineProperty(r, i, a) : r[i] = e[i] } r.default = e, t && t.set(e, r); return r }(r("./src/util/index.js")); function s() { if ("function" != typeof WeakMap) return null; var e = new WeakMap; return s = function () { return e }, e } function o(e) { return (o = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function u(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function l(e, t) { return !t || "object" !== o(t) && "function" != typeof t ? function (e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e }(e) : t } function c(e, t, r) { return (c = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function (e, t, r) { var n = function (e, t) { for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = h(e));); return e }(e, t); if (n) { var i = Object.getOwnPropertyDescriptor(n, t); return i.get ? i.get.call(r) : i.value } })(e, t, r || e) } function h(e) { return (h = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function d(e, t) { return (d = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var f = function (e) { function t(e) { var r; return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), (r = l(this, h(t).call(this, e))).params = e, r.media = { currentTime: 0, duration: 0, paused: !0, playbackRate: 1, play: function () { }, pause: function () { }, volume: 0 }, r.mediaType = e.mediaType.toLowerCase(), r.elementPosition = e.elementPosition, r.peaks = null, r.playbackRate = 1, r.volume = 1, r.isMuted = !1, r.buffer = null, r.onPlayEnd = null, r.mediaListeners = {}, r } var r, n, s; return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && d(e, t) }(t, i.default), r = t, (n = [{ key: "init", value: function () { this.setPlaybackRate(this.params.audioRate), this.createTimer() } }, { key: "_setupMediaListeners", value: function () { var e = this; this.mediaListeners.error = function () { e.fireEvent("error", "Error loading media element") }, this.mediaListeners.canplay = function () { e.fireEvent("canplay") }, this.mediaListeners.ended = function () { e.fireEvent("finish") }, this.mediaListeners.play = function () { e.fireEvent("play") }, this.mediaListeners.pause = function () { e.fireEvent("pause") }, this.mediaListeners.seeked = function (t) { e.fireEvent("seek") }, this.mediaListeners.volumechange = function (t) { e.isMuted = e.media.muted, e.isMuted ? e.volume = 0 : e.volume = e.media.volume, e.fireEvent("volume") }, Object.keys(this.mediaListeners).forEach(function (t) { e.media.removeEventListener(t, e.mediaListeners[t]), e.media.addEventListener(t, e.mediaListeners[t]) }) } }, { key: "createTimer", value: function () { var e = this; this.on("play", function t() { e.isPaused() || (e.fireEvent("audioprocess", e.getCurrentTime()), a.frame(t)()) }), this.on("pause", function () { e.fireEvent("audioprocess", e.getCurrentTime()) }) } }, { key: "load", value: function (e, t, r, n) { var i = document.createElement(this.mediaType); i.controls = this.params.mediaControls, i.autoplay = this.params.autoplay || !1, i.preload = null == n ? "auto" : n, i.src = e, i.style.width = "100%"; var a = t.querySelector(this.mediaType); a && t.removeChild(a), t.appendChild(i), this._load(i, r) } }, { key: "loadElt", value: function (e, t) { e.controls = this.params.mediaControls, e.autoplay = this.params.autoplay || !1, this._load(e, t) } }, { key: "_load", value: function (e, t) { if (!(e instanceof HTMLMediaElement) || void 0 === e.addEventListener) throw new Error("media parameter is not a valid media element"); "function" == typeof e.load && e.load(), this.media = e, this._setupMediaListeners(), this.peaks = t, this.onPlayEnd = null, this.buffer = null, this.isMuted = e.muted, this.setPlaybackRate(this.playbackRate), this.setVolume(this.volume) } }, { key: "isPaused", value: function () { return !this.media || this.media.paused } }, { key: "getDuration", value: function () { if (this.explicitDuration) return this.explicitDuration; var e = (this.buffer || this.media).duration; return e >= 1 / 0 && (e = this.media.seekable.end(0)), e } }, { key: "getCurrentTime", value: function () { return this.media && this.media.currentTime } }, { key: "getPlayedPercents", value: function () { return this.getCurrentTime() / this.getDuration() || 0 } }, { key: "getPlaybackRate", value: function () { return this.playbackRate || this.media.playbackRate } }, { key: "setPlaybackRate", value: function (e) { this.playbackRate = e || 1, this.media.playbackRate = this.playbackRate } }, { key: "seekTo", value: function (e) { null != e && (this.media.currentTime = e), this.clearPlayEnd() } }, { key: "play", value: function (e, t) { this.seekTo(e); var r = this.media.play(); return t && this.setPlayEnd(t), r } }, { key: "pause", value: function () { var e; return this.media && (e = this.media.pause()), this.clearPlayEnd(), e } }, { key: "setPlayEnd", value: function (e) { var t = this; this.clearPlayEnd(), this._onPlayEnd = function (r) { r >= e && (t.pause(), t.seekTo(e)) }, this.on("audioprocess", this._onPlayEnd) } }, { key: "clearPlayEnd", value: function () { this._onPlayEnd && (this.un("audioprocess", this._onPlayEnd), this._onPlayEnd = null) } }, { key: "getPeaks", value: function (e, r, n) { return this.buffer ? c(h(t.prototype), "getPeaks", this).call(this, e, r, n) : this.peaks || [] } }, { key: "setSinkId", value: function (e) { return e ? this.media.setSinkId ? this.media.setSinkId(e) : Promise.reject(new Error("setSinkId is not supported in your browser")) : Promise.reject(new Error("Invalid deviceId: " + e)) } }, { key: "getVolume", value: function () { return this.volume } }, { key: "setVolume", value: function (e) { this.volume = e, this.media.volume !== this.volume && (this.media.volume = this.volume) } }, { key: "destroy", value: function () { var e = this; this.pause(), this.unAll(), this.destroyed = !0, Object.keys(this.mediaListeners).forEach(function (t) { e.media && e.media.removeEventListener(t, e.mediaListeners[t]) }), this.params.removeMediaElementOnDestroy && this.media && this.media.parentNode && this.media.parentNode.removeChild(this.media), this.media = null } }]) && u(r.prototype, n), s && u(r, s), t }(); t.default = f, e.exports = t.default }, "./src/peakcache.js": function (e, t, r) { "use strict"; function n(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var i = function () { function e() { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.clearPeakCache() } var t, r, i; return t = e, (r = [{ key: "clearPeakCache", value: function () { this.peakCacheRanges = [], this.peakCacheLength = -1 } }, { key: "addRangeToPeakCache", value: function (e, t, r) { e != this.peakCacheLength && (this.clearPeakCache(), this.peakCacheLength = e); for (var n = [], i = 0; i < this.peakCacheRanges.length && this.peakCacheRanges[i] < t;)i++; for (i % 2 == 0 && n.push(t); i < this.peakCacheRanges.length && this.peakCacheRanges[i] <= r;)n.push(this.peakCacheRanges[i]), i++; i % 2 == 0 && n.push(r), n = n.filter(function (e, t, r) { return 0 == t ? e != r[t + 1] : t == r.length - 1 ? e != r[t - 1] : e != r[t - 1] && e != r[t + 1] }), this.peakCacheRanges = this.peakCacheRanges.concat(n), this.peakCacheRanges = this.peakCacheRanges.sort(function (e, t) { return e - t }).filter(function (e, t, r) { return 0 == t ? e != r[t + 1] : t == r.length - 1 ? e != r[t - 1] : e != r[t - 1] && e != r[t + 1] }); var a = []; for (i = 0; i < n.length; i += 2)a.push([n[i], n[i + 1]]); return a } }, { key: "getCacheRanges", value: function () { var e, t = []; for (e = 0; e < this.peakCacheRanges.length; e += 2)t.push([this.peakCacheRanges[e], this.peakCacheRanges[e + 1]]); return t } }]) && n(t.prototype, r), i && n(t, i), e }(); t.default = i, e.exports = t.default }, "./src/util/ajax.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { var t = new i.default, r = new XMLHttpRequest, n = !1; r.open(e.method || "GET", e.url, !0), r.responseType = e.responseType || "json", e.xhr && (e.xhr.requestHeaders && e.xhr.requestHeaders.forEach(function (e) { r.setRequestHeader(e.key, e.value) }), e.xhr.withCredentials && (r.withCredentials = !0)); return r.addEventListener("progress", function (e) { t.fireEvent("progress", e), e.lengthComputable && e.loaded == e.total && (n = !0) }), r.addEventListener("load", function (e) { n || t.fireEvent("progress", e), t.fireEvent("load", e), 200 == r.status || 206 == r.status ? t.fireEvent("success", r.response, e) : t.fireEvent("error", e) }), r.addEventListener("error", function (e) { return t.fireEvent("error", e) }), r.send(), t.xhr = r, t }; var n, i = (n = r("./src/util/observer.js")) && n.__esModule ? n : { default: n }; e.exports = t.default }, "./src/util/extend.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { console.warn("util.extend is deprecated; use Object.assign instead"); for (var t = arguments.length, r = new Array(t > 1 ? t - 1 : 0), n = 1; n < t; n++)r[n - 1] = arguments[n]; return r.forEach(function (t) { Object.keys(t).forEach(function (r) { e[r] = t[r] }) }), e }, e.exports = t.default }, "./src/util/fetch.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { if (!e) throw new Error("fetch options missing"); if (!e.url) throw new Error("fetch url missing"); var t = new i.default, r = new Headers, n = new Request(e.url); t.controller = new AbortController, e && e.requestHeaders && e.requestHeaders.forEach(function (e) { r.append(e.key, e.value) }); var a = e.responseType || "json", o = { method: e.method || "GET", headers: r, mode: e.mode || "cors", credentials: e.credentials || "same-origin", cache: e.cache || "default", redirect: e.redirect || "follow", referrer: e.referrer || "client", signal: t.controller.signal }; return fetch(n, o).then(function (e) { t.response = e; var r = !0; e.body || (r = !1); var n = e.headers.get("content-length"); return null === n && (r = !1), r ? (t.onProgress = function (e) { t.fireEvent("progress", e) }, new Response(new ReadableStream(new s(t, n, e)), o)) : e }).then(function (e) { var t; if (e.ok) switch (a) { case "arraybuffer": return e.arrayBuffer(); case "json": return e.json(); case "blob": return e.blob(); case "text": return e.text(); default: t = "Unknown responseType: " + a }throw t || (t = "HTTP error status: " + e.status), new Error(t) }).then(function (e) { t.fireEvent("success", e) }).catch(function (e) { t.fireEvent("error", e) }), t.fetchRequest = n, t }; var n, i = (n = r("./src/util/observer.js")) && n.__esModule ? n : { default: n }; function a(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } var s = function () { function e(t, r, n) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.instance = t, this.instance._reader = n.body.getReader(), this.total = parseInt(r, 10), this.loaded = 0 } var t, r, n; return t = e, (r = [{ key: "start", value: function (e) { var t = this; !function r() { t.instance._reader.read().then(function (n) { var i = n.done, a = n.value; if (i) return 0 === t.total && t.instance.onProgress.call(t.instance, { loaded: t.loaded, total: t.total, lengthComputable: !1 }), void e.close(); t.loaded += a.byteLength, t.instance.onProgress.call(t.instance, { loaded: t.loaded, total: t.total, lengthComputable: !(0 === t.total) }), e.enqueue(a), r() }).catch(function (t) { e.error(t) }) }() } }]) && a(t.prototype, r), n && a(t, n), e }(); e.exports = t.default }, "./src/util/frame.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { return function () { for (var t = arguments.length, r = new Array(t), n = 0; n < t; n++)r[n] = arguments[n]; return (0, i.default)(function () { return e.apply(void 0, r) }) } }; var n, i = (n = r("./src/util/request-animation-frame.js")) && n.__esModule ? n : { default: n }; e.exports = t.default }, "./src/util/get-id.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { void 0 === e && (e = "wavesurfer_"); return e + Math.random().toString(32).substring(2) }, e.exports = t.default }, "./src/util/index.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), Object.defineProperty(t, "ajax", { enumerable: !0, get: function () { return n.default } }), Object.defineProperty(t, "getId", { enumerable: !0, get: function () { return i.default } }), Object.defineProperty(t, "max", { enumerable: !0, get: function () { return a.default } }), Object.defineProperty(t, "min", { enumerable: !0, get: function () { return s.default } }), Object.defineProperty(t, "Observer", { enumerable: !0, get: function () { return o.default } }), Object.defineProperty(t, "extend", { enumerable: !0, get: function () { return u.default } }), Object.defineProperty(t, "style", { enumerable: !0, get: function () { return l.default } }), Object.defineProperty(t, "requestAnimationFrame", { enumerable: !0, get: function () { return c.default } }), Object.defineProperty(t, "frame", { enumerable: !0, get: function () { return h.default } }), Object.defineProperty(t, "debounce", { enumerable: !0, get: function () { return d.default } }), Object.defineProperty(t, "preventClick", { enumerable: !0, get: function () { return f.default } }), Object.defineProperty(t, "fetchFile", { enumerable: !0, get: function () { return p.default } }); var n = v(r("./src/util/ajax.js")), i = v(r("./src/util/get-id.js")), a = v(r("./src/util/max.js")), s = v(r("./src/util/min.js")), o = v(r("./src/util/observer.js")), u = v(r("./src/util/extend.js")), l = v(r("./src/util/style.js")), c = v(r("./src/util/request-animation-frame.js")), h = v(r("./src/util/frame.js")), d = v(r("./node_modules/debounce/index.js")), f = v(r("./src/util/prevent-click.js")), p = v(r("./src/util/fetch.js")); function v(e) { return e && e.__esModule ? e : { default: e } } }, "./src/util/max.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { var t = -1 / 0; return Object.keys(e).forEach(function (r) { e[r] > t && (t = e[r]) }), t }, e.exports = t.default }, "./src/util/min.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { var t = Number(1 / 0); return Object.keys(e).forEach(function (r) { e[r] < t && (t = e[r]) }), t }, e.exports = t.default }, "./src/util/observer.js": function (e, t, r) { "use strict"; function n(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var i = function () { function e() { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.handlers = null } var t, r, i; return t = e, (r = [{ key: "on", value: function (e, t) { var r = this; this.handlers || (this.handlers = {}); var n = this.handlers[e]; return n || (n = this.handlers[e] = []), n.push(t), { name: e, callback: t, un: function (e, t) { return r.un(e, t) } } } }, { key: "un", value: function (e, t) { if (this.handlers) { var r, n = this.handlers[e]; if (n) if (t) for (r = n.length - 1; r >= 0; r--)n[r] == t && n.splice(r, 1); else n.length = 0 } } }, { key: "unAll", value: function () { this.handlers = null } }, { key: "once", value: function (e, t) { var r = this; return this.on(e, function n() { for (var i = arguments.length, a = new Array(i), s = 0; s < i; s++)a[s] = arguments[s]; t.apply(r, a), setTimeout(function () { r.un(e, n) }, 0) }) } }, { key: "fireEvent", value: function (e) { for (var t = arguments.length, r = new Array(t > 1 ? t - 1 : 0), n = 1; n < t; n++)r[n - 1] = arguments[n]; if (this.handlers) { var i = this.handlers[e]; i && i.forEach(function (e) { e.apply(void 0, r) }) } } }]) && n(t.prototype, r), i && n(t, i), e }(); t.default = i, e.exports = t.default }, "./src/util/prevent-click.js": function (e, t, r) { "use strict"; function n(e) { e.stopPropagation(), document.body.removeEventListener("click", n, !0) } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { document.body.addEventListener("click", n, !0) }, e.exports = t.default }, "./src/util/request-animation-frame.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n = (window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (e, t) { return setTimeout(e, 1e3 / 60) }).bind(window); t.default = n, e.exports = t.default }, "./src/util/style.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e, t) { return Object.keys(t).forEach(function (r) { e.style[r] !== t[r] && (e.style[r] = t[r]) }), e }, e.exports = t.default }, "./src/wavesurfer.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n = function (e) { if (e && e.__esModule) return e; if (null === e || "object" !== h(e) && "function" != typeof e) return { default: e }; var t = c(); if (t && t.has(e)) return t.get(e); var r = {}, n = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var i in e) if (Object.prototype.hasOwnProperty.call(e, i)) { var a = n ? Object.getOwnPropertyDescriptor(e, i) : null; a && (a.get || a.set) ? Object.defineProperty(r, i, a) : r[i] = e[i] } r.default = e, t && t.set(e, r); return r }(r("./src/util/index.js")), i = l(r("./src/drawer.multicanvas.js")), a = l(r("./src/webaudio.js")), s = l(r("./src/mediaelement.js")), o = l(r("./src/peakcache.js")), u = l(r("./src/mediaelement-webaudio.js")); function l(e) { return e && e.__esModule ? e : { default: e } } function c() { if ("function" != typeof WeakMap) return null; var e = new WeakMap; return c = function () { return e }, e } function h(e) { return (h = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function d(e, t) { return !t || "object" !== h(t) && "function" != typeof t ? p(e) : t } function f(e) { return (f = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function p(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e } function v(e, t) { return (v = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } function m(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function y(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function g(e, t, r) { return t && y(e.prototype, t), r && y(e, r), e } var w = function (e) { function t(e) { var r; if (m(this, t), (r = d(this, f(t).call(this))).defaultParams = { audioContext: null, audioScriptProcessor: null, audioRate: 1, autoCenter: !0, autoCenterRate: 5, autoCenterImmediately: !1, backend: "WebAudio", backgroundColor: null, barHeight: 1, barRadius: 0, barGap: null, barMinHeight: null, container: null, cursorColor: "#333", cursorWidth: 1, dragSelection: !0, drawingContextAttributes: { desynchronized: !1 }, duration: null, fillParent: !0, forceDecode: !1, height: 128, hideScrollbar: !1, interact: !0, loopSelection: !0, maxCanvasWidth: 4e3, mediaContainer: null, mediaControls: !1, mediaType: "audio", minPxPerSec: 20, normalize: !1, partialRender: !1, pixelRatio: window.devicePixelRatio || screen.deviceXDPI / screen.logicalXDPI, plugins: [], progressColor: "#555", removeMediaElementOnDestroy: !0, renderer: i.default, responsive: !1, rtl: !1, scrollParent: !1, skipLength: 2, splitChannels: !1, waveColor: "#999", xhr: {} }, r.backends = { MediaElement: s.default, WebAudio: a.default, MediaElementWebAudio: u.default }, r.util = n, r.params = Object.assign({}, r.defaultParams, e), r.container = "string" == typeof e.container ? document.querySelector(r.params.container) : r.params.container, !r.container) throw new Error("Container element not found"); if (null == r.params.mediaContainer ? r.mediaContainer = r.container : "string" == typeof r.params.mediaContainer ? r.mediaContainer = document.querySelector(r.params.mediaContainer) : r.mediaContainer = r.params.mediaContainer, !r.mediaContainer) throw new Error("Media Container element not found"); if (r.params.maxCanvasWidth <= 1) throw new Error("maxCanvasWidth must be greater than 1"); if (r.params.maxCanvasWidth % 2 == 1) throw new Error("maxCanvasWidth must be an even number"); if (!0 === r.params.rtl && n.style(r.container, { transform: "rotateY(180deg)" }), r.params.backgroundColor && r.setBackgroundColor(r.params.backgroundColor), r.savedVolume = 0, r.isMuted = !1, r.tmpEvents = [], r.currentRequest = null, r.arraybuffer = null, r.drawer = null, r.backend = null, r.peakCache = null, "function" != typeof r.params.renderer) throw new Error("Renderer parameter is invalid"); r.Drawer = r.params.renderer, "AudioElement" == r.params.backend && (r.params.backend = "MediaElement"), "WebAudio" != r.params.backend && "MediaElementWebAudio" !== r.params.backend || a.default.prototype.supportsWebAudio.call(null) || (r.params.backend = "MediaElement"), r.Backend = r.backends[r.params.backend], r.initialisedPluginList = {}, r.isDestroyed = !1, r.isReady = !1; var o = 0; return r._onResize = n.debounce(function () { o == r.drawer.wrapper.clientWidth || r.params.scrollParent || (o = r.drawer.wrapper.clientWidth, r.drawer.fireEvent("redraw")) }, "number" == typeof r.params.responsive ? r.params.responsive : 100), d(r, p(r)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && v(e, t) }(t, n.Observer), g(t, null, [{ key: "create", value: function (e) { return new t(e).init() } }]), g(t, [{ key: "init", value: function () { return this.registerPlugins(this.params.plugins), this.createDrawer(), this.createBackend(), this.createPeakCache(), this } }, { key: "registerPlugins", value: function (e) { var t = this; return e.forEach(function (e) { return t.addPlugin(e) }), e.forEach(function (e) { e.deferInit || t.initPlugin(e.name) }), this.fireEvent("plugins-registered", e), this } }, { key: "getActivePlugins", value: function () { return this.initialisedPluginList } }, { key: "addPlugin", value: function (e) { var t = this; if (!e.name) throw new Error("Plugin does not have a name!"); if (!e.instance) throw new Error("Plugin ".concat(e.name, " does not have an instance property!")); e.staticProps && Object.keys(e.staticProps).forEach(function (r) { t[r] = e.staticProps[r] }); var r = e.instance; return Object.getOwnPropertyNames(n.Observer.prototype).forEach(function (e) { r.prototype[e] = n.Observer.prototype[e] }), this[e.name] = new r(e.params || {}, this), this.fireEvent("plugin-added", e.name), this } }, { key: "initPlugin", value: function (e) { if (!this[e]) throw new Error("Plugin ".concat(e, " has not been added yet!")); return this.initialisedPluginList[e] && this.destroyPlugin(e), this[e].init(), this.initialisedPluginList[e] = !0, this.fireEvent("plugin-initialised", e), this } }, { key: "destroyPlugin", value: function (e) { if (!this[e]) throw new Error("Plugin ".concat(e, " has not been added yet and cannot be destroyed!")); if (!this.initialisedPluginList[e]) throw new Error("Plugin ".concat(e, " is not active and cannot be destroyed!")); if ("function" != typeof this[e].destroy) throw new Error("Plugin ".concat(e, " does not have a destroy function!")); return this[e].destroy(), delete this.initialisedPluginList[e], this.fireEvent("plugin-destroyed", e), this } }, { key: "destroyAllPlugins", value: function () { var e = this; Object.keys(this.initialisedPluginList).forEach(function (t) { return e.destroyPlugin(t) }) } }, { key: "createDrawer", value: function () { var e = this; this.drawer = new this.Drawer(this.container, this.params), this.drawer.init(), this.fireEvent("drawer-created", this.drawer), !1 !== this.params.responsive && (window.addEventListener("resize", this._onResize, !0), window.addEventListener("orientationchange", this._onResize, !0)), this.drawer.on("redraw", function () { e.drawBuffer(), e.drawer.progress(e.backend.getPlayedPercents()) }), this.drawer.on("click", function (t, r) { setTimeout(function () { return e.seekTo(r) }, 0) }), this.drawer.on("scroll", function (t) { e.params.partialRender && e.drawBuffer(), e.fireEvent("scroll", t) }) } }, { key: "createBackend", value: function () { var e = this; this.backend && this.backend.destroy(), this.backend = new this.Backend(this.params), this.backend.init(), this.fireEvent("backend-created", this.backend), this.backend.on("finish", function () { e.drawer.progress(e.backend.getPlayedPercents()), e.fireEvent("finish") }), this.backend.on("play", function () { return e.fireEvent("play") }), this.backend.on("pause", function () { return e.fireEvent("pause") }), this.backend.on("audioprocess", function (t) { e.drawer.progress(e.backend.getPlayedPercents()), e.fireEvent("audioprocess", t) }), "MediaElement" !== this.params.backend && "MediaElementWebAudio" !== this.params.backend || (this.backend.on("seek", function () { e.drawer.progress(e.backend.getPlayedPercents()) }), this.backend.on("volume", function () { var t = e.getVolume(); e.fireEvent("volume", t), e.backend.isMuted !== e.isMuted && (e.isMuted = e.backend.isMuted, e.fireEvent("mute", e.isMuted)) })) } }, { key: "createPeakCache", value: function () { this.params.partialRender && (this.peakCache = new o.default) } }, { key: "getDuration", value: function () { return this.backend.getDuration() } }, { key: "getCurrentTime", value: function () { return this.backend.getCurrentTime() } }, { key: "setCurrentTime", value: function (e) { e >= this.getDuration() ? this.seekTo(1) : this.seekTo(e / this.getDuration()) } }, { key: "play", value: function (e, t) { var r = this; return this.fireEvent("interaction", function () { return r.play(e, t) }), this.backend.play(e, t) } }, { key: "setPlayEnd", value: function (e) { this.backend.setPlayEnd(e) } }, { key: "pause", value: function () { if (!this.backend.isPaused()) return this.backend.pause() } }, { key: "playPause", value: function () { return this.backend.isPaused() ? this.play() : this.pause() } }, { key: "isPlaying", value: function () { return !this.backend.isPaused() } }, { key: "skipBackward", value: function (e) { this.skip(-e || -this.params.skipLength) } }, { key: "skipForward", value: function (e) { this.skip(e || this.params.skipLength) } }, { key: "skip", value: function (e) { var t = this.getDuration() || 1, r = this.getCurrentTime() || 0; r = Math.max(0, Math.min(t, r + (e || 0))), this.seekAndCenter(r / t) } }, { key: "seekAndCenter", value: function (e) { this.seekTo(e), this.drawer.recenter(e) } }, { key: "seekTo", value: function (e) { var t = this; if ("number" != typeof e || !isFinite(e) || e < 0 || e > 1) throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!"); this.fireEvent("interaction", function () { return t.seekTo(e) }); var r = this.backend.isPaused(); r || this.backend.pause(); var n = this.params.scrollParent; this.params.scrollParent = !1, this.backend.seekTo(e * this.getDuration()), this.drawer.progress(e), r || this.backend.play(), this.params.scrollParent = n, this.fireEvent("seek", e) } }, { key: "stop", value: function () { this.pause(), this.seekTo(0), this.drawer.progress(0) } }, { key: "setSinkId", value: function (e) { return this.backend.setSinkId(e) } }, { key: "setVolume", value: function (e) { this.backend.setVolume(e), this.fireEvent("volume", e) } }, { key: "getVolume", value: function () { return this.backend.getVolume() } }, { key: "setPlaybackRate", value: function (e) { this.backend.setPlaybackRate(e) } }, { key: "getPlaybackRate", value: function () { return this.backend.getPlaybackRate() } }, { key: "toggleMute", value: function () { this.setMute(!this.isMuted) } }, { key: "setMute", value: function (e) { e !== this.isMuted ? (e ? (this.savedVolume = this.backend.getVolume(), this.backend.setVolume(0), this.isMuted = !0, this.fireEvent("volume", 0)) : (this.backend.setVolume(this.savedVolume), this.isMuted = !1, this.fireEvent("volume", this.savedVolume)), this.fireEvent("mute", this.isMuted)) : this.fireEvent("mute", this.isMuted) } }, { key: "getMute", value: function () { return this.isMuted } }, { key: "getFilters", value: function () { return this.backend.filters || [] } }, { key: "toggleScroll", value: function () { this.params.scrollParent = !this.params.scrollParent, this.drawBuffer() } }, { key: "toggleInteraction", value: function () { this.params.interact = !this.params.interact } }, { key: "getWaveColor", value: function () { return this.params.waveColor } }, { key: "setWaveColor", value: function (e) { this.params.waveColor = e, this.drawBuffer() } }, { key: "getProgressColor", value: function () { return this.params.progressColor } }, { key: "setProgressColor", value: function (e) { this.params.progressColor = e, this.drawBuffer() } }, { key: "getBackgroundColor", value: function () { return this.params.backgroundColor } }, { key: "setBackgroundColor", value: function (e) { this.params.backgroundColor = e, n.style(this.container, { background: this.params.backgroundColor }) } }, { key: "getCursorColor", value: function () { return this.params.cursorColor } }, { key: "setCursorColor", value: function (e) { this.params.cursorColor = e, this.drawer.updateCursor() } }, { key: "getHeight", value: function () { return this.params.height } }, { key: "setHeight", value: function (e) { this.params.height = e, this.drawer.setHeight(e * this.params.pixelRatio), this.drawBuffer() } }, { key: "drawBuffer", value: function () { var e, t = Math.round(this.getDuration() * this.params.minPxPerSec * this.params.pixelRatio), r = this.drawer.getWidth(), n = t, i = 0, a = Math.max(i + r, n); if (this.params.fillParent && (!this.params.scrollParent || t < r) && (i = 0, a = n = r), this.params.partialRender) { var s, o = this.peakCache.addRangeToPeakCache(n, i, a); for (s = 0; s < o.length; s++)e = this.backend.getPeaks(n, o[s][0], o[s][1]), this.drawer.drawPeaks(e, n, o[s][0], o[s][1]) } else e = this.backend.getPeaks(n, i, a), this.drawer.drawPeaks(e, n, i, a); this.fireEvent("redraw", e, n) } }, { key: "zoom", value: function (e) { e ? (this.params.minPxPerSec = e, this.params.scrollParent = !0) : (this.params.minPxPerSec = this.defaultParams.minPxPerSec, this.params.scrollParent = !1), this.drawBuffer(), this.drawer.progress(this.backend.getPlayedPercents()), this.drawer.recenter(this.getCurrentTime() / this.getDuration()), this.fireEvent("zoom", e) } }, { key: "loadArrayBuffer", value: function (e) { var t = this; this.decodeArrayBuffer(e, function (e) { t.isDestroyed || t.loadDecodedBuffer(e) }) } }, { key: "loadDecodedBuffer", value: function (e) { this.backend.load(e), this.drawBuffer(), this.isReady = !0, this.fireEvent("ready") } }, { key: "loadBlob", value: function (e) { var t = this, r = new FileReader; r.addEventListener("progress", function (e) { return t.onProgress(e) }), r.addEventListener("load", function (e) { return t.loadArrayBuffer(e.target.result) }), r.addEventListener("error", function () { return t.fireEvent("error", "Error reading file") }), r.readAsArrayBuffer(e), this.empty() } }, { key: "load", value: function (e, t, r, n) { if (!e) throw new Error("url parameter cannot be empty"); if (this.empty(), r) { var i = { "Preload is not 'auto', 'none' or 'metadata'": -1 === ["auto", "metadata", "none"].indexOf(r), "Peaks are not provided": !t, "Backend is not of type 'MediaElement' or 'MediaElementWebAudio'": -1 === ["MediaElement", "MediaElementWebAudio"].indexOf(this.params.backend), "Url is not of type string": "string" != typeof e }, a = Object.keys(i).filter(function (e) { return i[e] }); a.length && (console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- " + a.join("\n\t- ")), r = null) } switch (this.params.backend) { case "WebAudio": return this.loadBuffer(e, t, n); case "MediaElement": case "MediaElementWebAudio": return this.loadMediaElement(e, t, r, n) } } }, { key: "loadBuffer", value: function (e, t, r) { var n = this, i = function (t) { return t && n.tmpEvents.push(n.once("ready", t)), n.getArrayBuffer(e, function (e) { return n.loadArrayBuffer(e) }) }; if (!t) return i(); this.backend.setPeaks(t, r), this.drawBuffer(), this.tmpEvents.push(this.once("interaction", i)) } }, { key: "loadMediaElement", value: function (e, t, r, n) { var i = this, a = e; if ("string" == typeof e) this.backend.load(a, this.mediaContainer, t, r); else { var s = e; this.backend.loadElt(s, t), a = s.src } this.tmpEvents.push(this.backend.once("canplay", function () { i.backend.destroyed || (i.drawBuffer(), i.isReady = !0, i.fireEvent("ready")) }), this.backend.once("error", function (e) { return i.fireEvent("error", e) })), t && this.backend.setPeaks(t, n), t && !this.params.forceDecode || !this.backend.supportsWebAudio() || this.getArrayBuffer(a, function (e) { i.decodeArrayBuffer(e, function (e) { i.backend.buffer = e, i.backend.setPeaks(null), i.drawBuffer(), i.fireEvent("waveform-ready") }) }) } }, { key: "decodeArrayBuffer", value: function (e, t) { var r = this; this.arraybuffer = e, this.backend.decodeArrayBuffer(e, function (n) { r.isDestroyed || r.arraybuffer != e || (t(n), r.arraybuffer = null) }, function () { return r.fireEvent("error", "Error decoding audiobuffer") }) } }, { key: "getArrayBuffer", value: function (e, t) { var r = this, i = Object.assign({ url: e, responseType: "arraybuffer" }, this.params.xhr), a = n.fetchFile(i); return this.currentRequest = a, this.tmpEvents.push(a.on("progress", function (e) { r.onProgress(e) }), a.on("success", function (e) { t(e), r.currentRequest = null }), a.on("error", function (e) { r.fireEvent("error", e), r.currentRequest = null })), a } }, { key: "onProgress", value: function (e) { var t; t = e.lengthComputable ? e.loaded / e.total : e.loaded / (e.loaded + 1e6), this.fireEvent("loading", Math.round(100 * t), e.target) } }, { key: "exportPCM", value: function (e, t, r, n, i) { e = e || 1024, n = n || 0, t = t || 1e4, r = r || !1; var a = this.backend.getPeaks(e, n, i), s = [].map.call(a, function (e) { return Math.round(e * t) / t }); return new Promise(function (e, t) { var n = JSON.stringify(s); r || window.open("data:application/json;charset=utf-8," + encodeURIComponent(n)), e(n) }) } }, { key: "exportImage", value: function (e, t, r) { return e || (e = "image/png"), t || (t = 1), r || (r = "dataURL"), this.drawer.getImage(e, t, r) } }, { key: "cancelAjax", value: function () { this.currentRequest && this.currentRequest.controller && (this.currentRequest.controller.abort(), this.currentRequest = null) } }, { key: "clearTmpEvents", value: function () { this.tmpEvents.forEach(function (e) { return e.un() }) } }, { key: "empty", value: function () { this.backend.isPaused() || (this.stop(), this.backend.disconnectSource()), this.isReady = !1, this.cancelAjax(), this.clearTmpEvents(), this.drawer.progress(0), this.drawer.setWidth(0), this.drawer.drawPeaks({ length: this.drawer.getWidth() }, 0) } }, { key: "destroy", value: function () { this.destroyAllPlugins(), this.fireEvent("destroy"), this.cancelAjax(), this.clearTmpEvents(), this.unAll(), !1 !== this.params.responsive && (window.removeEventListener("resize", this._onResize, !0), window.removeEventListener("orientationchange", this._onResize, !0)), this.backend && this.backend.destroy(), this.drawer && this.drawer.destroy(), this.isDestroyed = !0, this.isReady = !1, this.arraybuffer = null } }]), t }(); t.default = w, w.VERSION = "3.3.3", w.util = n, e.exports = t.default }, "./src/webaudio.js": function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var n = function (e) { if (e && e.__esModule) return e; if (null === e || "object" !== a(e) && "function" != typeof e) return { default: e }; var t = i(); if (t && t.has(e)) return t.get(e); var r = {}, n = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var s in e) if (Object.prototype.hasOwnProperty.call(e, s)) { var o = n ? Object.getOwnPropertyDescriptor(e, s) : null; o && (o.get || o.set) ? Object.defineProperty(r, s, o) : r[s] = e[s] } r.default = e, t && t.set(e, r); return r }(r("./src/util/index.js")); function i() { if ("function" != typeof WeakMap) return null; var e = new WeakMap; return i = function () { return e }, e } function a(e) { return (a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function s(e, t, r) { return t in e ? Object.defineProperty(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = r, e } function o(e, t) { return !t || "object" !== a(t) && "function" != typeof t ? function (e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e }(e) : t } function u(e) { return (u = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function l(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function c(e, t, r) { return t && l(e.prototype, t), r && l(e, r), e } function h(e, t) { return (h = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var d = "playing", f = "paused", p = "finished", v = function (e) { function t(e) { var r, n, i; return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), (i = o(this, u(t).call(this))).audioContext = null, i.offlineAudioContext = null, i.stateBehaviors = (s(r = {}, d, { init: function () { this.addOnAudioProcess() }, getPlayedPercents: function () { var e = this.getDuration(); return this.getCurrentTime() / e || 0 }, getCurrentTime: function () { return this.startPosition + this.getPlayedTime() } }), s(r, f, { init: function () { this.removeOnAudioProcess() }, getPlayedPercents: function () { var e = this.getDuration(); return this.getCurrentTime() / e || 0 }, getCurrentTime: function () { return this.startPosition } }), s(r, p, { init: function () { this.removeOnAudioProcess(), this.fireEvent("finish") }, getPlayedPercents: function () { return 1 }, getCurrentTime: function () { return this.getDuration() } }), r), i.params = e, i.ac = e.audioContext || (i.supportsWebAudio() ? i.getAudioContext() : {}), i.lastPlay = i.ac.currentTime, i.startPosition = 0, i.scheduledPause = null, i.states = (s(n = {}, d, Object.create(i.stateBehaviors[d])), s(n, f, Object.create(i.stateBehaviors[f])), s(n, p, Object.create(i.stateBehaviors[p])), n), i.buffer = null, i.filters = [], i.gainNode = null, i.mergedPeaks = null, i.offlineAc = null, i.peaks = null, i.playbackRate = 1, i.analyser = null, i.scriptNode = null, i.source = null, i.splitPeaks = [], i.state = null, i.explicitDuration = e.duration, i.destroyed = !1, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && h(e, t) }(t, n.Observer), c(t, [{ key: "supportsWebAudio", value: function () { return !(!window.AudioContext && !window.webkitAudioContext) } }, { key: "getAudioContext", value: function () { return window.WaveSurferAudioContext || (window.WaveSurferAudioContext = new (window.AudioContext || window.webkitAudioContext)), window.WaveSurferAudioContext } }, { key: "getOfflineAudioContext", value: function (e) { return window.WaveSurferOfflineAudioContext || (window.WaveSurferOfflineAudioContext = new (window.OfflineAudioContext || window.webkitOfflineAudioContext)(1, 2, e)), window.WaveSurferOfflineAudioContext } }]), c(t, [{ key: "init", value: function () { this.createVolumeNode(), this.createScriptNode(), this.createAnalyserNode(), this.setState(f), this.setPlaybackRate(this.params.audioRate), this.setLength(0) } }, { key: "disconnectFilters", value: function () { this.filters && (this.filters.forEach(function (e) { e && e.disconnect() }), this.filters = null, this.analyser.connect(this.gainNode)) } }, { key: "setState", value: function (e) { this.state !== this.states[e] && (this.state = this.states[e], this.state.init.call(this)) } }, { key: "setFilter", value: function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; this.setFilters(t) } }, { key: "setFilters", value: function (e) { this.disconnectFilters(), e && e.length && (this.filters = e, this.analyser.disconnect(), e.reduce(function (e, t) { return e.connect(t), t }, this.analyser).connect(this.gainNode)) } }, { key: "createScriptNode", value: function () { this.params.audioScriptProcessor ? this.scriptNode = this.params.audioScriptProcessor : this.ac.createScriptProcessor ? this.scriptNode = this.ac.createScriptProcessor(t.scriptBufferSize) : this.scriptNode = this.ac.createJavaScriptNode(t.scriptBufferSize), this.scriptNode.connect(this.ac.destination) } }, { key: "addOnAudioProcess", value: function () { var e = this; this.scriptNode.onaudioprocess = function () { var t = e.getCurrentTime(); t >= e.getDuration() ? (e.setState(p), e.fireEvent("pause")) : t >= e.scheduledPause ? e.pause() : e.state === e.states[d] && e.fireEvent("audioprocess", t) } } }, { key: "removeOnAudioProcess", value: function () { this.scriptNode.onaudioprocess = function () { } } }, { key: "createAnalyserNode", value: function () { this.analyser = this.ac.createAnalyser(), this.analyser.connect(this.gainNode) } }, { key: "createVolumeNode", value: function () { this.ac.createGain ? this.gainNode = this.ac.createGain() : this.gainNode = this.ac.createGainNode(), this.gainNode.connect(this.ac.destination) } }, { key: "setSinkId", value: function (e) { if (e) { var t = new window.Audio; if (!t.setSinkId) return Promise.reject(new Error("setSinkId is not supported in your browser")); t.autoplay = !0; var r = this.ac.createMediaStreamDestination(); return this.gainNode.disconnect(), this.gainNode.connect(r), t.srcObject = r.stream, t.setSinkId(e) } return Promise.reject(new Error("Invalid deviceId: " + e)) } }, { key: "setVolume", value: function (e) { this.gainNode.gain.setValueAtTime(e, this.ac.currentTime) } }, { key: "getVolume", value: function () { return this.gainNode.gain.value } }, { key: "decodeArrayBuffer", value: function (e, t, r) { this.offlineAc || (this.offlineAc = this.getOfflineAudioContext(this.ac && this.ac.sampleRate ? this.ac.sampleRate : 44100)), this.offlineAc.decodeAudioData(e, function (e) { return t(e) }, r) } }, { key: "setPeaks", value: function (e, t) { null != t && (this.explicitDuration = t), this.peaks = e } }, { key: "setLength", value: function (e) { if (!this.mergedPeaks || e != 2 * this.mergedPeaks.length - 1 + 2) { this.splitPeaks = [], this.mergedPeaks = []; var t, r = this.buffer ? this.buffer.numberOfChannels : 1; for (t = 0; t < r; t++)this.splitPeaks[t] = [], this.splitPeaks[t][2 * (e - 1)] = 0, this.splitPeaks[t][2 * (e - 1) + 1] = 0; this.mergedPeaks[2 * (e - 1)] = 0, this.mergedPeaks[2 * (e - 1) + 1] = 0 } } }, { key: "getPeaks", value: function (e, t, r) { if (this.peaks) return this.peaks; if (!this.buffer) return []; if (t = t || 0, r = r || e - 1, this.setLength(e), !this.buffer) return this.params.splitChannels ? this.splitPeaks : this.mergedPeaks; if (!this.buffer.length) { var n = this.createBuffer(1, 4096, this.sampleRate); this.buffer = n.buffer } var i, a = this.buffer.length / e, s = ~~(a / 10) || 1, o = this.buffer.numberOfChannels; for (i = 0; i < o; i++) { var u = this.splitPeaks[i], l = this.buffer.getChannelData(i), c = void 0; for (c = t; c <= r; c++) { var h = ~~(c * a), d = ~~(h + a), f = 0, p = 0, v = void 0; for (v = h; v < d; v += s) { var m = l[v]; m > p && (p = m), m < f && (f = m) } u[2 * c] = p, u[2 * c + 1] = f, (0 == i || p > this.mergedPeaks[2 * c]) && (this.mergedPeaks[2 * c] = p), (0 == i || f < this.mergedPeaks[2 * c + 1]) && (this.mergedPeaks[2 * c + 1] = f) } } return this.params.splitChannels ? this.splitPeaks : this.mergedPeaks } }, { key: "getPlayedPercents", value: function () { return this.state.getPlayedPercents.call(this) } }, { key: "disconnectSource", value: function () { this.source && this.source.disconnect() } }, { key: "destroy", value: function () { this.isPaused() || this.pause(), this.unAll(), this.buffer = null, this.destroyed = !0, this.disconnectFilters(), this.disconnectSource(), this.gainNode.disconnect(), this.scriptNode.disconnect(), this.analyser.disconnect(), this.params.closeAudioContext && ("function" == typeof this.ac.close && "closed" != this.ac.state && this.ac.close(), this.ac = null, this.params.audioContext ? this.params.audioContext = null : window.WaveSurferAudioContext = null, window.WaveSurferOfflineAudioContext = null) } }, { key: "load", value: function (e) { this.startPosition = 0, this.lastPlay = this.ac.currentTime, this.buffer = e, this.createSource() } }, { key: "createSource", value: function () { this.disconnectSource(), this.source = this.ac.createBufferSource(), this.source.start = this.source.start || this.source.noteGrainOn, this.source.stop = this.source.stop || this.source.noteOff, this.source.playbackRate.setValueAtTime(this.playbackRate, this.ac.currentTime), this.source.buffer = this.buffer, this.source.connect(this.analyser) } }, { key: "isPaused", value: function () { return this.state !== this.states[d] } }, { key: "getDuration", value: function () { return this.explicitDuration ? this.explicitDuration : this.buffer ? this.buffer.duration : 0 } }, { key: "seekTo", value: function (e, t) { if (this.buffer) return this.scheduledPause = null, null == e && (e = this.getCurrentTime()) >= this.getDuration() && (e = 0), null == t && (t = this.getDuration()), this.startPosition = e, this.lastPlay = this.ac.currentTime, this.state === this.states[p] && this.setState(f), { start: e, end: t } } }, { key: "getPlayedTime", value: function () { return (this.ac.currentTime - this.lastPlay) * this.playbackRate } }, { key: "play", value: function (e, t) { if (this.buffer) { this.createSource(); var r = this.seekTo(e, t); e = r.start, t = r.end, this.scheduledPause = t, this.source.start(0, e), "suspended" == this.ac.state && this.ac.resume && this.ac.resume(), this.setState(d), this.fireEvent("play") } } }, { key: "pause", value: function () { this.scheduledPause = null, this.startPosition += this.getPlayedTime(), this.source && this.source.stop(0), this.setState(f), this.fireEvent("pause") } }, { key: "getCurrentTime", value: function () { return this.state.getCurrentTime.call(this) } }, { key: "getPlaybackRate", value: function () { return this.playbackRate } }, { key: "setPlaybackRate", value: function (e) { e = e || 1, this.isPaused() ? this.playbackRate = e : (this.pause(), this.playbackRate = e, this.play()) } }, { key: "setPlayEnd", value: function (e) { this.scheduledPause = e } }]), t }(); t.default = v, v.scriptBufferSize = 256, e.exports = t.default } }) }), function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("regions", [], t) : "object" == typeof exports ? exports.regions = t() : (e.WaveSurfer = e.WaveSurfer || {}, e.WaveSurfer.regions = t()) }(window, function () { return function (e) { var t = {}; function r(n) { if (t[n]) return t[n].exports; var i = t[n] = { i: n, l: !1, exports: {} }; return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports } return r.m = e, r.c = t, r.d = function (e, t, n) { r.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n }) }, r.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, r.t = function (e, t) { if (1 & t && (e = r(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var n = Object.create(null); if (r.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) r.d(n, i, function (t) { return e[t] }.bind(null, i)); return n }, r.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return r.d(t, "a", t), t }, r.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, r.p = "localhost:8080/dist/plugin/", r(r.s = "./src/plugin/regions.js") }({ "./src/plugin/regions.js": function (e, t, r) { "use strict"; function n(e, t) { var r = Object.keys(e); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); t && (n = n.filter(function (t) { return Object.getOwnPropertyDescriptor(e, t).enumerable })), r.push.apply(r, n) } return r } function i(e, t, r) { return t in e ? Object.defineProperty(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = r, e } function a(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function s(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function o(e, t, r) { return t && s(e.prototype, t), r && s(e, r), e } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var u = function () { function e(t, r) { var n = this; a(this, e), this.wavesurfer = r, this.wrapper = r.drawer.wrapper, this.util = r.util, this.style = this.util.style, this.id = null == t.id ? r.util.getId() : t.id, this.start = Number(t.start) || 0, this.end = null == t.end ? this.start + 4 / this.wrapper.scrollWidth * this.wavesurfer.getDuration() : Number(t.end), this.resize = void 0 === t.resize || Boolean(t.resize), this.drag = void 0 === t.drag || Boolean(t.drag), this.isResizing = !1, this.isDragging = !1, this.loop = Boolean(t.loop), this.color = t.color || "rgba(0, 0, 0, 0.1)", this.handleStyle = t.handleStyle || { left: {}, right: {} }, this.data = t.data || {}, this.attributes = t.attributes || {}, this.maxLength = t.maxLength, this.minLength = t.minLength, this._onRedraw = function () { return n.updateRender() }, this.scroll = !1 !== t.scroll && r.params.scrollParent, this.scrollSpeed = t.scrollSpeed || 1, this.scrollThreshold = t.scrollThreshold || 10, this.preventContextMenu = void 0 !== t.preventContextMenu && Boolean(t.preventContextMenu); var i = null == t.channelIdx ? -1 : parseInt(t.channelIdx); this.regionHeight = "100%", this.marginTop = "0px"; var s = this.wavesurfer.backend.ac.destination.channelCount; i >= 0 && i < s && (this.regionHeight = Math.floor(1 / s * 100) + "%", this.marginTop = this.wavesurfer.getHeight() * i + "px"), this.bindInOut(), this.render(), this.wavesurfer.on("zoom", this._onRedraw), this.wavesurfer.on("redraw", this._onRedraw), this.wavesurfer.fireEvent("region-created", this) } return o(e, [{ key: "update", value: function (e) { null != e.start && (this.start = Number(e.start)), null != e.end && (this.end = Number(e.end)), null != e.loop && (this.loop = Boolean(e.loop)), null != e.color && (this.color = e.color), null != e.handleStyle && (this.handleStyle = e.handleStyle), null != e.data && (this.data = e.data), null != e.resize && (this.resize = Boolean(e.resize)), null != e.drag && (this.drag = Boolean(e.drag)), null != e.maxLength && (this.maxLength = Number(e.maxLength)), null != e.minLength && (this.minLength = Number(e.minLength)), null != e.attributes && (this.attributes = e.attributes), this.updateRender(), this.fireEvent("update"), this.wavesurfer.fireEvent("region-updated", this) } }, { key: "remove", value: function () { this.element && (this.wrapper.removeChild(this.element), this.element = null, this.fireEvent("remove"), this.wavesurfer.un("zoom", this._onRedraw), this.wavesurfer.un("redraw", this._onRedraw), this.wavesurfer.fireEvent("region-removed", this)) } }, { key: "play", value: function (e) { var t = e || this.start; this.wavesurfer.play(t, this.end), this.fireEvent("play"), this.wavesurfer.fireEvent("region-play", this) } }, { key: "playLoop", value: function (e) { var t = this; this.play(e), this.once("out", function () { return t.playLoop() }) } }, { key: "render", value: function () { var e = document.createElement("region"); for (var t in e.className = "wavesurfer-region", e.title = this.formatTime(this.start, this.end), e.setAttribute("data-id", this.id), this.attributes) e.setAttribute("data-region-" + t, this.attributes[t]); if (this.style(e, { position: "absolute", zIndex: 2, height: this.regionHeight, top: this.marginTop }), this.resize) { var r = e.appendChild(document.createElement("handle")), n = e.appendChild(document.createElement("handle")); r.className = "wavesurfer-handle wavesurfer-handle-start", n.className = "wavesurfer-handle wavesurfer-handle-end"; var i = { cursor: "col-resize", position: "absolute", top: "0px", width: "1%", maxWidth: "4px", height: "100%", backgroundColor: "rgba(0, 0, 0, 1)" }, a = "none" !== this.handleStyle.left ? Object.assign({ left: "0px" }, i, this.handleStyle.left) : null, s = "none" !== this.handleStyle.right ? Object.assign({ right: "0px" }, i, this.handleStyle.right) : null; a && this.style(r, a), s && this.style(n, s) } this.element = this.wrapper.appendChild(e), this.updateRender(), this.bindEvents(e) } }, { key: "formatTime", value: function (e, t) { return (e == t ? [e] : [e, t]).map(function (e) { return [Math.floor(e % 3600 / 60), ("00" + Math.floor(e % 60)).slice(-2)].join(":") }).join("-") } }, { key: "getWidth", value: function () { return this.wavesurfer.drawer.width / this.wavesurfer.params.pixelRatio } }, { key: "updateRender", value: function () { var e = this.wavesurfer.getDuration(), t = this.getWidth(), r = this.start, n = this.end; if (r < 0 && (n -= r = 0), n > e && (r = e - ((n = e) - r)), null != this.minLength && (n = Math.max(r + this.minLength, n)), null != this.maxLength && (n = Math.min(r + this.maxLength, n)), null != this.element) { var i = Math.round(r / e * t), a = Math.round(n / e * t) - i; for (var s in this.style(this.element, { left: i + "px", width: a + "px", backgroundColor: this.color, cursor: this.drag ? "move" : "default" }), this.attributes) this.element.setAttribute("data-region-" + s, this.attributes[s]); this.element.title = this.formatTime(this.start, this.end) } } }, { key: "bindInOut", value: function () { var e = this; this.firedIn = !1, this.firedOut = !1; var t = function (t) { var r = Math.round(10 * e.start) / 10, n = Math.round(10 * e.end) / 10; t = Math.round(10 * t) / 10, !e.firedOut && e.firedIn && (r > t || n <= t) && (e.firedOut = !0, e.firedIn = !1, e.fireEvent("out"), e.wavesurfer.fireEvent("region-out", e)), !e.firedIn && r <= t && n > t && (e.firedIn = !0, e.firedOut = !1, e.fireEvent("in"), e.wavesurfer.fireEvent("region-in", e)) }; this.wavesurfer.backend.on("audioprocess", t), this.on("remove", function () { e.wavesurfer.backend.un("audioprocess", t) }), this.on("out", function () { e.loop && e.wavesurfer.play(e.start) }) } }, { key: "bindEvents", value: function () { var e = this, t = this.preventContextMenu; this.element.addEventListener("mouseenter", function (t) { e.fireEvent("mouseenter", t), e.wavesurfer.fireEvent("region-mouseenter", e, t) }), this.element.addEventListener("mouseleave", function (t) { e.fireEvent("mouseleave", t), e.wavesurfer.fireEvent("region-mouseleave", e, t) }), this.element.addEventListener("click", function (t) { t.preventDefault(), e.fireEvent("click", t), e.wavesurfer.fireEvent("region-click", e, t) }), this.element.addEventListener("dblclick", function (t) { t.stopPropagation(), t.preventDefault(), e.fireEvent("dblclick", t), e.wavesurfer.fireEvent("region-dblclick", e, t) }), this.element.addEventListener("contextmenu", function (r) { t && r.preventDefault(), e.fireEvent("contextmenu", r), e.wavesurfer.fireEvent("region-contextmenu", e, r) }), (this.drag || this.resize) && this.bindDragEvents() } }, { key: "bindDragEvents", value: function () { var e, t, r, n, i, a, s, o = this, u = this.wavesurfer.drawer.container, l = this.scrollSpeed, c = this.scrollThreshold, h = !1, d = function (a) { var u = o.wavesurfer.getDuration(); a.touches && a.touches.length > 1 || (t = a.targetTouches ? a.targetTouches[0].identifier : null, (o.drag || o.resize) && a.stopPropagation(), e = o.wavesurfer.regions.util.getRegionSnapToGridValue(o.wavesurfer.drawer.handleEvent(a, !0) * u), n = o.wrapper.scrollWidth - o.wrapper.clientWidth, s = o.wrapper.getBoundingClientRect(), o.isResizing = !1, o.isDragging = !1, "handle" === a.target.tagName.toLowerCase() ? (o.isResizing = !0, i = a.target.classList.contains("wavesurfer-handle-start") ? "start" : "end") : (o.isDragging = !0, r = !0, i = !1)) }, f = function (e) { e.touches && e.touches.length > 1 || ((r || i) && (o.isDragging = !1, o.isResizing = !1, r = !1, a = null, i = !1), h && (h = !1, o.util.preventClick(), o.fireEvent("update-end", e), o.wavesurfer.fireEvent("region-update-end", o, e))) }, p = function (d) { var f = o.wavesurfer.getDuration(); if (!(d.touches && d.touches.length > 1) && (!d.targetTouches || d.targetTouches[0].identifier == t) && (r || i)) { var p = e, v = o.wavesurfer.regions.util.getRegionSnapToGridValue(o.wavesurfer.drawer.handleEvent(d) * f), m = v - e; if (e = v, o.drag && r && (h = h || !!m, o.onDrag(m)), o.resize && i && (h = h || !!m, o.onResize(m, i)), o.scroll && u.clientWidth < o.wrapper.scrollWidth) { if (r) { var y = o.element.getBoundingClientRect(), g = y.left - s.left; v < p && g >= 0 ? a = -1 : v > p && g + y.width <= s.right && (a = 1), (-1 === a && g > c || 1 === a && g + y.width < s.right - c) && (a = null) } else { var w = d.clientX - s.left; a = w <= c ? -1 : w >= s.right - c ? 1 : null } a && function t(s) { var u = o.wavesurfer.getDuration(); if (a && (r || i)) { var c = o.wrapper.scrollLeft + l * a; o.wrapper.scrollLeft = c = Math.min(n, Math.max(0, c)); var h = o.wavesurfer.regions.util.getRegionSnapToGridValue(o.wavesurfer.drawer.handleEvent(s) * u), d = h - e; e = h, r ? o.onDrag(d) : o.onResize(d, i), window.requestAnimationFrame(function () { t(s) }) } }(d) } } }; this.element.addEventListener("mousedown", d), this.element.addEventListener("touchstart", d), this.wrapper.addEventListener("mousemove", p), this.wrapper.addEventListener("touchmove", p), document.body.addEventListener("mouseup", f), document.body.addEventListener("touchend", f), this.on("remove", function () { document.body.removeEventListener("mouseup", f), document.body.removeEventListener("touchend", f), o.wrapper.removeEventListener("mousemove", p), o.wrapper.removeEventListener("touchmove", p) }), this.wavesurfer.on("destroy", function () { document.body.removeEventListener("mouseup", f), document.body.removeEventListener("touchend", f) }) } }, { key: "onDrag", value: function (e) { var t = this.wavesurfer.getDuration(); this.end + e > t || this.start + e < 0 || this.update({ start: this.start + e, end: this.end + e }) } }, { key: "onResize", value: function (e, t) { "start" === t ? this.update({ start: Math.min(this.start + e, this.end), end: Math.max(this.start + e, this.end) }) : this.update({ start: Math.min(this.end + e, this.start), end: Math.max(this.end + e, this.start) }) } }]), e }(), l = function () { function e(t, r) { var s = this; a(this, e), this.params = t, this.wavesurfer = r, this.util = function (e) { for (var t = 1; t < arguments.length; t++) { var r = null != arguments[t] ? arguments[t] : {}; t % 2 ? n(Object(r), !0).forEach(function (t) { i(e, t, r[t]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : n(Object(r)).forEach(function (t) { Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t)) }) } return e }({}, r.util, { getRegionSnapToGridValue: function (e) { return s.getRegionSnapToGridValue(e, t) } }), this.maxRegions = t.maxRegions, Object.getOwnPropertyNames(this.util.Observer.prototype).forEach(function (e) { u.prototype[e] = s.util.Observer.prototype[e] }), this.wavesurfer.Region = u, this._onBackendCreated = function () { s.wrapper = s.wavesurfer.drawer.wrapper, s.params.regions && s.params.regions.forEach(function (e) { s.add(e) }) }, this.list = {}, this._onReady = function () { s.wrapper = s.wavesurfer.drawer.wrapper, s.params.dragSelection && s.enableDragSelection(s.params), Object.keys(s.list).forEach(function (e) { s.list[e].updateRender() }) } } return o(e, null, [{ key: "create", value: function (t) { return { name: "regions", deferInit: !(!t || !t.deferInit) && t.deferInit, params: t, staticProps: { addRegion: function (e) { return this.initialisedPluginList.regions || this.initPlugin("regions"), this.regions.add(e) }, clearRegions: function () { this.regions && this.regions.clear() }, enableDragSelection: function (e) { this.initialisedPluginList.regions || this.initPlugin("regions"), this.regions.enableDragSelection(e) }, disableDragSelection: function () { this.regions.disableDragSelection() } }, instance: e } } }]), o(e, [{ key: "init", value: function () { this.wavesurfer.isReady ? (this._onBackendCreated(), this._onReady()) : (this.wavesurfer.once("ready", this._onReady), this.wavesurfer.once("backend-created", this._onBackendCreated)) } }, { key: "destroy", value: function () { this.wavesurfer.un("ready", this._onReady), this.wavesurfer.un("backend-created", this._onBackendCreated), this.disableDragSelection(), this.clear() } }, { key: "wouldExceedMaxRegions", value: function () { return this.maxRegions && Object.keys(this.list).length >= this.maxRegions } }, { key: "add", value: function (e) { var t = this; if (this.wouldExceedMaxRegions()) return null; var r = new this.wavesurfer.Region(e, this.wavesurfer); return this.list[r.id] = r, r.on("remove", function () { delete t.list[r.id] }), r } }, { key: "clear", value: function () { var e = this; Object.keys(this.list).forEach(function (t) { e.list[t].remove() }) } }, { key: "enableDragSelection", value: function (e) { var t = this; this.disableDragSelection(); var r, n, i, a, s, o, u, l = e.slop || 2, c = this.wavesurfer.drawer.container, h = !1 !== e.scroll && this.wavesurfer.params.scrollParent, d = e.scrollSpeed || 1, f = e.scrollThreshold || 10, p = this.wavesurfer.getDuration(), v = 0, m = function (e) { e.touches && e.touches.length > 1 || (p = t.wavesurfer.getDuration(), s = e.targetTouches ? e.targetTouches[0].identifier : null, n = t.wrapper.scrollWidth - t.wrapper.clientWidth, u = t.wrapper.getBoundingClientRect(), r = !0, i = t.wavesurfer.drawer.handleEvent(e, !0), a = null, o = null) }; this.wrapper.addEventListener("mousedown", m), this.wrapper.addEventListener("touchstart", m), this.on("disable-drag-selection", function () { t.wrapper.removeEventListener("touchstart", m), t.wrapper.removeEventListener("mousedown", m) }); var y = function (e) { e.touches && e.touches.length > 1 || (r = !1, v = 0, o = null, a && (t.util.preventClick(), a.fireEvent("update-end", e), t.wavesurfer.fireEvent("region-update-end", a, e)), a = null) }; this.wrapper.addEventListener("mouseup", y), this.wrapper.addEventListener("touchend", y), document.body.addEventListener("mouseup", y), document.body.addEventListener("touchend", y), this.on("disable-drag-selection", function () { document.body.removeEventListener("mouseup", y), document.body.removeEventListener("touchend", y), t.wrapper.removeEventListener("touchend", y), t.wrapper.removeEventListener("mouseup", y) }); var g = function (m) { if (r && !(++v <= l) && !(m.touches && m.touches.length > 1) && (!m.targetTouches || m.targetTouches[0].identifier == s) && (a || (a = t.add(e || {})))) { var y = t.wavesurfer.drawer.handleEvent(m), g = t.wavesurfer.regions.util.getRegionSnapToGridValue(i * p), w = t.wavesurfer.regions.util.getRegionSnapToGridValue(y * p); if (a.update({ start: Math.min(w, g), end: Math.max(w, g) }), h && c.clientWidth < t.wrapper.scrollWidth) { var b = m.clientX - u.left; (o = b <= f ? -1 : b >= u.right - f ? 1 : null) && function e(r) { if (a && o) { var s = t.wrapper.scrollLeft + d * o; t.wrapper.scrollLeft = s = Math.min(n, Math.max(0, s)); var u = t.wavesurfer.drawer.handleEvent(r); a.update({ start: Math.min(u * p, i * p), end: Math.max(u * p, i * p) }), s < n && s > 0 && window.requestAnimationFrame(function () { e(r) }) } }(m) } } }; this.wrapper.addEventListener("mousemove", g), this.wrapper.addEventListener("touchmove", g), this.on("disable-drag-selection", function () { t.wrapper.removeEventListener("touchmove", g), t.wrapper.removeEventListener("mousemove", g) }) } }, { key: "disableDragSelection", value: function () { this.fireEvent("disable-drag-selection") } }, { key: "getCurrentRegion", value: function () { var e = this, t = this.wavesurfer.getCurrentTime(), r = null; return Object.keys(this.list).forEach(function (n) { var i = e.list[n]; i.start <= t && i.end >= t && (!r || i.end - i.start < r.end - r.start) && (r = i) }), r } }, { key: "getRegionSnapToGridValue", value: function (e, t) { if (t.snapToGridInterval) { var r = t.snapToGridOffset || 0; return Math.round((e - r) / t.snapToGridInterval) * t.snapToGridInterval + r } return e } }]), e }(); t.default = l, e.exports = t.default } }) }), function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("cursor", [], t) : "object" == typeof exports ? exports.cursor = t() : (e.WaveSurfer = e.WaveSurfer || {}, e.WaveSurfer.cursor = t()) }(window, function () { return function (e) { var t = {}; function r(n) { if (t[n]) return t[n].exports; var i = t[n] = { i: n, l: !1, exports: {} }; return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports } return r.m = e, r.c = t, r.d = function (e, t, n) { r.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n }) }, r.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, r.t = function (e, t) { if (1 & t && (e = r(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var n = Object.create(null); if (r.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) r.d(n, i, function (t) { return e[t] }.bind(null, i)); return n }, r.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return r.d(t, "a", t), t }, r.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, r.p = "localhost:8080/dist/plugin/", r(r.s = "./src/plugin/cursor.js") }({ "./src/plugin/cursor.js": function (e, t, r) { "use strict"; function n(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function i(e, t, r) { return t && n(e.prototype, t), r && n(e, r), e } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var a = function () { function e(t, r) { var n = this; !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.defaultParams = { hideOnBlur: !0, width: "1px", color: "black", opacity: "0.25", style: "solid", zIndex: 4, customStyle: {}, customShowTimeStyle: {}, showTime: !1, followCursorY: !1, formatTimeCallback: null }, this._onMousemove = function (e) { var t = n.wavesurfer.container.getBoundingClientRect(), r = 0, i = e.clientX - t.left, a = t.right < e.clientX + n.outerWidth(n.displayTime); n.params.showTime && n.params.followCursorY && (r = e.clientY - (t.top + t.height / 2)), n.updateCursorPosition(i, r, a) }, this._onMouseenter = function () { return n.showCursor() }, this._onMouseleave = function () { return n.hideCursor() }, this.wavesurfer = r, this.style = r.util.style, this.cursor = null, this.showTime = null, this.displayTime = null, this.params = Object.assign({}, this.defaultParams, t) } return i(e, null, [{ key: "create", value: function (t) { return { name: "cursor", deferInit: !(!t || !t.deferInit) && t.deferInit, params: t, staticProps: {}, instance: e } } }]), i(e, [{ key: "init", value: function () { this.wrapper = this.wavesurfer.container, this.cursor = this.wrapper.appendChild(this.style(document.createElement("cursor"), Object.assign({ position: "absolute", zIndex: this.params.zIndex, left: 0, top: 0, bottom: 0, width: "0", display: "flex", borderRightStyle: this.params.style, borderRightWidth: this.params.width, borderRightColor: this.params.color, opacity: this.params.opacity, pointerEvents: "none" }, this.params.customStyle))), this.params.showTime && (this.showTime = this.wrapper.appendChild(this.style(document.createElement("showTitle"), Object.assign({ position: "absolute", zIndex: this.params.zIndex, left: 0, top: 0, bottom: 0, width: "auto", display: "flex", opacity: this.params.opacity, pointerEvents: "none", height: "100%" }, this.params.customStyle))), this.displayTime = this.showTime.appendChild(this.style(document.createElement("div"), Object.assign({ display: "inline", pointerEvents: "none", margin: "auto", visibility: "hidden" }, this.params.customShowTimeStyle))), this.displayTime.innerHTML = this.formatTime(0)), this.wrapper.addEventListener("mousemove", this._onMousemove), this.params.hideOnBlur && (this.hideCursor(), this.wrapper.addEventListener("mouseenter", this._onMouseenter), this.wrapper.addEventListener("mouseleave", this._onMouseleave)) } }, { key: "destroy", value: function () { this.params.showTime && this.cursor.parentNode.removeChild(this.showTime), this.cursor.parentNode.removeChild(this.cursor), this.wrapper.removeEventListener("mousemove", this._onMousemove), this.params.hideOnBlur && (this.wrapper.removeEventListener("mouseenter", this._onMouseenter), this.wrapper.removeEventListener("mouseleave", this._onMouseleave)) } }, { key: "updateCursorPosition", value: function (e, t) { var r = arguments.length > 2 && void 0 !== arguments[2] && arguments[2]; if (this.style(this.cursor, { left: "".concat(e, "px") }), this.params.showTime) { var n = this.wavesurfer.getDuration(), i = this.wavesurfer.drawer.width / this.wavesurfer.params.pixelRatio, a = this.wavesurfer.drawer.getScrollX(), s = n / this.wavesurfer.drawer.width * a, o = Math.max(0, e / i * n) + s, u = this.formatTime(o); if (r) e -= this.outerWidth(this.displayTime); this.style(this.showTime, { left: "".concat(e, "px"), top: "".concat(t, "px") }), this.style(this.displayTime, { visibility: "visible" }), this.displayTime.innerHTML = "".concat(u) } } }, { key: "showCursor", value: function () { this.style(this.cursor, { display: "flex" }), this.params.showTime && this.style(this.showTime, { display: "flex" }) } }, { key: "hideCursor", value: function () { this.style(this.cursor, { display: "none" }), this.params.showTime && this.style(this.showTime, { display: "none" }) } }, { key: "formatTime", value: function (e) { return e = isNaN(e) ? 0 : e, this.params.formatTimeCallback ? this.params.formatTimeCallback(e) : [e].map(function (e) { return [Math.floor(e % 3600 / 60), ("00" + Math.floor(e % 60)).slice(-2), ("000" + Math.floor(e % 1 * 1e3)).slice(-3)].join(":") }) } }, { key: "outerWidth", value: function (e) { if (!e) return 0; var t = e.offsetWidth, r = getComputedStyle(e); return t += parseInt(r.marginLeft + r.marginRight) } }]), e }(); t.default = a, e.exports = t.default } }) }), function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("timeline", [], t) : "object" == typeof exports ? exports.timeline = t() : (e.WaveSurfer = e.WaveSurfer || {}, e.WaveSurfer.timeline = t()) }(window, function () { return function (e) { var t = {}; function r(n) { if (t[n]) return t[n].exports; var i = t[n] = { i: n, l: !1, exports: {} }; return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports } return r.m = e, r.c = t, r.d = function (e, t, n) { r.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n }) }, r.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, r.t = function (e, t) { if (1 & t && (e = r(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var n = Object.create(null); if (r.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) r.d(n, i, function (t) { return e[t] }.bind(null, i)); return n }, r.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return r.d(t, "a", t), t }, r.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, r.p = "localhost:8080/dist/plugin/", r(r.s = "./src/plugin/timeline.js") }({ "./src/plugin/timeline.js": function (e, t, r) { "use strict"; function n(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function i(e, t, r) { return t && n(e.prototype, t), r && n(e, r), e } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var a = function () { function e(t, r) { var n = this; if (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), s.call(this), this.container = "string" == typeof t.container ? document.querySelector(t.container) : t.container, !this.container) throw new Error("No container for wavesurfer timeline"); this.wavesurfer = r, this.util = r.util, this.params = Object.assign({}, { height: 20, notchPercentHeight: 90, labelPadding: 5, unlabeledNotchColor: "#c0c0c0", primaryColor: "#000", secondaryColor: "#c0c0c0", primaryFontColor: "#000", secondaryFontColor: "#000", fontFamily: "Arial", fontSize: 10, duration: null, zoomDebounce: !1, formatTimeCallback: this.defaultFormatTimeCallback, timeInterval: this.defaultTimeInterval, primaryLabelInterval: this.defaultPrimaryLabelInterval, secondaryLabelInterval: this.defaultSecondaryLabelInterval, offset: 0 }, t), this.canvases = [], this.wrapper = null, this.drawer = null, this.pixelRatio = null, this.maxCanvasWidth = null, this.maxCanvasElementWidth = null, this._onZoom = this.params.zoomDebounce ? this.wavesurfer.util.debounce(function () { return n.render() }, this.params.zoomDebounce) : function () { return n.render() } } return i(e, null, [{ key: "create", value: function (t) { return { name: "timeline", deferInit: !(!t || !t.deferInit) && t.deferInit, params: t, instance: e } } }]), i(e, [{ key: "init", value: function () { this.wavesurfer.isReady ? this._onReady() : this.wavesurfer.once("ready", this._onReady) } }, { key: "destroy", value: function () { this.unAll(), this.wavesurfer.un("redraw", this._onRedraw), this.wavesurfer.un("zoom", this._onZoom), this.wavesurfer.un("ready", this._onReady), this.wavesurfer.drawer.wrapper.removeEventListener("scroll", this._onScroll), this.wrapper && this.wrapper.parentNode && (this.wrapper.removeEventListener("click", this._onWrapperClick), this.wrapper.parentNode.removeChild(this.wrapper), this.wrapper = null) } }, { key: "createWrapper", value: function () { var e = this.wavesurfer.params; this.container.innerHTML = "", this.wrapper = this.container.appendChild(document.createElement("timeline")), this.util.style(this.wrapper, { display: "block", position: "relative", userSelect: "none", webkitUserSelect: "none", height: "".concat(this.params.height, "px") }), (e.fillParent || e.scrollParent) && this.util.style(this.wrapper, { width: "100%", overflowX: "hidden", overflowY: "hidden" }), this.wrapper.addEventListener("click", this._onWrapperClick) } }, { key: "render", value: function () { this.wrapper || this.createWrapper(), this.updateCanvases(), this.updateCanvasesPositioning(), this.renderCanvases() } }, { key: "addCanvas", value: function () { var e = this.wrapper.appendChild(document.createElement("canvas")); this.canvases.push(e), this.util.style(e, { position: "absolute", zIndex: 4 }) } }, { key: "removeCanvas", value: function () { var e = this.canvases.pop(); e.parentElement.removeChild(e) } }, { key: "updateCanvases", value: function () { for (var e = Math.round(this.drawer.wrapper.scrollWidth), t = Math.ceil(e / this.maxCanvasElementWidth); this.canvases.length < t;)this.addCanvas(); for (; this.canvases.length > t;)this.removeCanvas() } }, { key: "updateCanvasesPositioning", value: function () { var e = this, t = this.canvases.length; this.canvases.forEach(function (r, n) { var i = n === t - 1 ? e.drawer.wrapper.scrollWidth - e.maxCanvasElementWidth * (t - 1) : e.maxCanvasElementWidth; r.width = i * e.pixelRatio, r.height = (e.params.height + 1) * e.pixelRatio, e.util.style(r, { width: "".concat(i, "px"), height: "".concat(e.params.height, "px"), left: "".concat(n * e.maxCanvasElementWidth, "px") }) }) } }, { key: "renderCanvases", value: function () { var e = this, t = this.wavesurfer.timeline.params.duration || this.wavesurfer.backend.getDuration(); if (!(t <= 0)) { var r, n = this.wavesurfer.params, i = this.params.fontSize * n.pixelRatio, a = parseInt(t, 10) + 1, s = n.fillParent && !n.scrollParent ? this.drawer.getWidth() : this.drawer.wrapper.scrollWidth * n.pixelRatio, o = this.params.height * this.pixelRatio, u = this.params.height * (this.params.notchPercentHeight / 100) * this.pixelRatio, l = s / t, c = this.params.formatTimeCallback, h = function (e) { return "function" == typeof e ? e(l) : e }, d = h(this.params.timeInterval), f = h(this.params.primaryLabelInterval), p = h(this.params.secondaryLabelInterval), v = l * this.params.offset, m = 0, y = []; for (r = 0; r < a / d; r++)y.push([r, m, v]), m += d, v += l * d; var g = function (e) { y.forEach(function (t) { e(t[0], t[1], t[2]) }) }; this.setFillStyles(this.params.primaryColor), this.setFonts("".concat(i, "px ").concat(this.params.fontFamily)), this.setFillStyles(this.params.primaryFontColor), g(function (t, r, n) { t % f == 0 && (e.fillRect(n, 0, 1, o), e.fillText(c(r, l), n + e.params.labelPadding * e.pixelRatio, o)) }), this.setFillStyles(this.params.secondaryColor), this.setFonts("".concat(i, "px ").concat(this.params.fontFamily)), this.setFillStyles(this.params.secondaryFontColor), g(function (t, r, n) { t % p == 0 && (e.fillRect(n, 0, 1, o), e.fillText(c(r, l), n + e.params.labelPadding * e.pixelRatio, o)) }), this.setFillStyles(this.params.unlabeledNotchColor), g(function (t, r, n) { t % p != 0 && t % f != 0 && e.fillRect(n, 0, 1, u) }) } } }, { key: "setFillStyles", value: function (e) { this.canvases.forEach(function (t) { t.getContext("2d").fillStyle = e }) } }, { key: "setFonts", value: function (e) { this.canvases.forEach(function (t) { t.getContext("2d").font = e }) } }, { key: "fillRect", value: function (e, t, r, n) { var i = this; this.canvases.forEach(function (a, s) { var o = s * i.maxCanvasWidth, u = { x1: Math.max(e, s * i.maxCanvasWidth), y1: t, x2: Math.min(e + r, s * i.maxCanvasWidth + a.width), y2: t + n }; u.x1 < u.x2 && a.getContext("2d").fillRect(u.x1 - o, u.y1, u.x2 - u.x1, u.y2 - u.y1) }) } }, { key: "fillText", value: function (e, t, r) { var n, i = 0; this.canvases.forEach(function (a) { var s = a.getContext("2d"), o = s.canvas.width; i > t + n || (i + o > t && (n = s.measureText(e).width, s.fillText(e, t - i, r)), i += o) }) } }, { key: "defaultFormatTimeCallback", value: function (e, t) { if (e / 60 > 1) { var r = parseInt(e / 60, 10); return e = (e = parseInt(e % 60, 10)) < 10 ? "0" + e : e, "".concat(r, ":").concat(e) } return Math.round(1e3 * e) / 1e3 } }, { key: "defaultTimeInterval", value: function (e) { return e >= 25 ? 1 : 5 * e >= 25 ? 5 : 15 * e >= 25 ? 15 : 60 * Math.ceil(.5 / e) } }, { key: "defaultPrimaryLabelInterval", value: function (e) { return e >= 25 ? 10 : 5 * e >= 25 ? 6 : 4 } }, { key: "defaultSecondaryLabelInterval", value: function (e) { return e >= 25 ? 5 : 2 } }]), e }(); t.default = a; var s = function () { var e = this; this._onScroll = function () { e.wrapper && e.drawer.wrapper && (e.wrapper.scrollLeft = e.drawer.wrapper.scrollLeft) }, this._onRedraw = function () { return e.render() }, this._onReady = function () { var t = e.wavesurfer; e.drawer = t.drawer, e.pixelRatio = t.drawer.params.pixelRatio, e.maxCanvasWidth = t.drawer.maxCanvasWidth || t.drawer.width, e.maxCanvasElementWidth = t.drawer.maxCanvasElementWidth || Math.round(e.maxCanvasWidth / e.pixelRatio), t.drawer.wrapper.addEventListener("scroll", e._onScroll), t.on("redraw", e._onRedraw), t.on("zoom", e._onZoom), e.render() }, this._onWrapperClick = function (t) { t.preventDefault(); var r = "offsetX" in t ? t.offsetX : t.layerX; e.fireEvent("click", r / e.wrapper.scrollWidth || 0) } }; e.exports = t.default } }) }), function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("minimap", [], t) : "object" == typeof exports ? exports.minimap = t() : (e.WaveSurfer = e.WaveSurfer || {}, e.WaveSurfer.minimap = t()) }(window, function () { return function (e) { var t = {}; function r(n) { if (t[n]) return t[n].exports; var i = t[n] = { i: n, l: !1, exports: {} }; return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports } return r.m = e, r.c = t, r.d = function (e, t, n) { r.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n }) }, r.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, r.t = function (e, t) { if (1 & t && (e = r(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var n = Object.create(null); if (r.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) r.d(n, i, function (t) { return e[t] }.bind(null, i)); return n }, r.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return r.d(t, "a", t), t }, r.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, r.p = "localhost:8080/dist/plugin/", r(r.s = "./src/plugin/minimap.js") }({ "./src/plugin/minimap.js": function (e, t, r) { "use strict"; function n(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function i(e, t, r) { return t && n(e.prototype, t), r && n(e, r), e } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var a = function () { function e(t, r) { var n = this; if (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.params = Object.assign({}, r.params, { showRegions: !1, showOverview: !1, overviewBorderColor: "green", overviewBorderSize: 2, container: !1, height: Math.max(Math.round(r.params.height / 4), 20) }, t, { scrollParent: !1, fillParent: !0 }), "string" == typeof t.container) { var i = document.querySelector(t.container); i || console.warn("Wavesurfer minimap container ".concat(t.container, " was not found! The minimap will be automatically appended below the waveform.")), this.params.container = i } t.container || (this.params.container = r.util.style(document.createElement("minimap"), { display: "block" })), this.drawer = new r.Drawer(this.params.container, this.params), this.wavesurfer = r, this.util = r.util, this.renderEvent = "MediaElement" === r.params.backend ? "waveform-ready" : "ready", this.overviewRegion = null, this.drawer.createWrapper(), this.createElements(); var a = !1; this._onShouldRender = function () { a || (n.bindWavesurferEvents(), n.bindMinimapEvents(), a = !0), document.body.contains(n.params.container) || r.container.insertBefore(n.params.container, null), n.wavesurfer.regions && n.params.showRegions && n.regions(), n.render() }, this._onAudioprocess = function (e) { n.drawer.progress(n.wavesurfer.backend.getPlayedPercents()) }, this._onSeek = function () { return n.drawer.progress(r.backend.getPlayedPercents()) }, this._onScroll = function (e) { n.draggingOverview || n.moveOverviewRegion(e.target.scrollLeft / n.ratio) }, this._onMouseover = function (e) { n.draggingOverview && (n.draggingOverview = !1) }; var s = 0; this._onResize = r.util.debounce(function () { s != n.drawer.wrapper.clientWidth && (s = n.drawer.wrapper.clientWidth, n.render(), n.drawer.progress(n.wavesurfer.backend.getPlayedPercents())) }), this._onZoom = function (e) { n.render() }, this.wavesurfer.on("zoom", this._onZoom) } return i(e, null, [{ key: "create", value: function (t) { return { name: "minimap", deferInit: !(!t || !t.deferInit) && t.deferInit, params: t, staticProps: {}, instance: e } } }]), i(e, [{ key: "init", value: function () { this.wavesurfer.isReady && this._onShouldRender(), this.wavesurfer.on(this.renderEvent, this._onShouldRender) } }, { key: "destroy", value: function () { window.removeEventListener("resize", this._onResize, !0), window.removeEventListener("orientationchange", this._onResize, !0), this.wavesurfer.drawer.wrapper.removeEventListener("mouseover", this._onMouseover), this.wavesurfer.un(this.renderEvent, this._onShouldRender), this.wavesurfer.un("seek", this._onSeek), this.wavesurfer.un("scroll", this._onScroll), this.wavesurfer.un("audioprocess", this._onAudioprocess), this.wavesurfer.un("zoom", this._onZoom), this.drawer.destroy(), this.overviewRegion = null, this.unAll() } }, { key: "regions", value: function () { var e = this; this.regions = {}, this.wavesurfer.on("region-created", function (t) { e.regions[t.id] = t, e.renderRegions() }), this.wavesurfer.on("region-updated", function (t) { e.regions[t.id] = t, e.renderRegions() }), this.wavesurfer.on("region-removed", function (t) { delete e.regions[t.id], e.renderRegions() }) } }, { key: "renderRegions", value: function () { var e, t = this, r = this.drawer.wrapper.querySelectorAll("region"); for (e = 0; e < r.length; ++e)this.drawer.wrapper.removeChild(r[e]); Object.keys(this.regions).forEach(function (e) { var r = t.regions[e], n = t.getWidth() * ((r.end - r.start) / t.wavesurfer.getDuration()), i = t.getWidth() * (r.start / t.wavesurfer.getDuration()), a = t.util.style(document.createElement("region"), { height: "inherit", backgroundColor: r.color, width: n + "px", left: i + "px", display: "block", position: "absolute" }); a.classList.add(e), t.drawer.wrapper.appendChild(a) }) } }, { key: "createElements", value: function () { this.drawer.createElements(), this.params.showOverview && (this.overviewRegion = this.util.style(document.createElement("overview"), { top: 0, bottom: 0, width: "0px", display: "block", position: "absolute", cursor: "move", border: this.params.overviewBorderSize + "px solid " + this.params.overviewBorderColor, zIndex: 2, opacity: this.params.overviewOpacity }), this.drawer.wrapper.appendChild(this.overviewRegion)) } }, { key: "bindWavesurferEvents", value: function () { window.addEventListener("resize", this._onResize, !0), window.addEventListener("orientationchange", this._onResize, !0), this.wavesurfer.on("audioprocess", this._onAudioprocess), this.wavesurfer.on("seek", this._onSeek), this.params.showOverview && (this.wavesurfer.on("scroll", this._onScroll), this.wavesurfer.drawer.wrapper.addEventListener("mouseover", this._onMouseover)) } }, { key: "bindMinimapEvents", value: function () { var e = this, t = { clientX: 0, clientY: 0 }, r = 0, n = !0; this.params.interact && (this.drawer.wrapper.addEventListener("click", function (t) { e.fireEvent("click", t, e.drawer.handleEvent(t)) }), this.on("click", function (t, r) { n ? (e.drawer.progress(r), e.wavesurfer.seekAndCenter(r)) : n = !0 })), this.params.showOverview && (this.overviewRegion.addEventListener("mousedown", function (n) { e.draggingOverview = !0, r = n.layerX, t.clientX = n.clientX, t.clientY = n.clientY }), this.drawer.wrapper.addEventListener("mousemove", function (t) { e.draggingOverview && e.moveOverviewRegion(t.clientX - e.drawer.container.getBoundingClientRect().left - r) }), this.drawer.wrapper.addEventListener("mouseup", function (r) { t.clientX - r.clientX == 0 && t.clientX - r.clientX == 0 ? (n = !0, e.draggingOverview = !1) : e.draggingOverview && (n = !1, e.draggingOverview = !1) })) } }, { key: "render", value: function () { var e = this.drawer.getWidth(), t = this.wavesurfer.backend.getPeaks(e, 0, e); this.drawer.drawPeaks(t, e, 0, e), this.drawer.progress(this.wavesurfer.backend.getPlayedPercents()), this.params.showOverview && (this.ratio = this.wavesurfer.drawer.width / this.drawer.width, this.waveShowedWidth = this.wavesurfer.drawer.width / this.ratio, this.waveWidth = this.wavesurfer.drawer.width, this.overviewWidth = this.drawer.container.offsetWidth / this.ratio, this.overviewPosition = 0, this.moveOverviewRegion(this.wavesurfer.drawer.wrapper.scrollLeft / this.ratio), this.overviewRegion.style.width = this.overviewWidth + "px") } }, { key: "moveOverviewRegion", value: function (e) { e < 0 ? this.overviewPosition = 0 : e + this.overviewWidth < this.drawer.container.offsetWidth ? this.overviewPosition = e : this.overviewPosition = this.drawer.container.offsetWidth - this.overviewWidth, this.overviewRegion.style.left = this.overviewPosition + "px", this.draggingOverview && (this.wavesurfer.drawer.wrapper.scrollLeft = this.overviewPosition * this.ratio) } }, { key: "getWidth", value: function () { return this.drawer.width / this.params.pixelRatio } }]), e }(); t.default = a, e.exports = t.default } }) });
//# sourceMappingURL=wavesurfer.min.js.map